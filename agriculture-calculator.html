<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üåæ WIT 365 Calculator Pro - ‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏Ñ‡∏¥‡∏î‡πÄ‡∏•‡∏Ç‡πÄ‡∏Å‡∏©‡∏ï‡∏£‡∏≠‡∏±‡∏à‡∏â‡∏£‡∏¥‡∏¢‡∏∞</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Sarabun:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --primary-color: #2ecc71;
            --secondary-color: #27ae60;
            --accent-color: #f1c40f;
            --text-color: #2c3e50;
            --bg-color: #f0f9f4;
        }
        
        body {
            font-family: 'Sarabun', sans-serif;
            background-color: var(--bg-color);
            color: var(--text-color);
        }
        
        .header {
            background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
            color: white;
            padding: 2rem 0;
            margin-bottom: 2rem;
            box-shadow: 0 4px 15px rgba(46, 204, 113, 0.3);
        }
        
        .card {
            border: none;
            border-radius: 15px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.05);
            transition: transform 0.3s ease;
            margin-bottom: 1.5rem;
        }
        
        .card:hover {
            transform: translateY(-5px);
        }
        
        .card-header {
            background-color: white;
            border-bottom: 2px solid var(--bg-color);
            font-weight: 600;
            color: var(--secondary-color);
            border-radius: 15px 15px 0 0 !important;
            padding: 1rem 1.5rem;
        }
        
        .btn-calc {
            background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
            color: white;
            border: none;
            padding: 10px 25px;
            border-radius: 30px;
            font-weight: 600;
            width: 100%;
            transition: all 0.3s ease;
        }
        
        .btn-calc:hover {
            transform: scale(1.02);
            box-shadow: 0 5px 15px rgba(46, 204, 113, 0.4);
            color: white;
        }
        
        .result-box {
            background-color: #e8f8f5;
            border-radius: 10px;
            padding: 15px;
            margin-top: 15px;
            border-left: 5px solid var(--primary-color);
            display: none;
        }
        
        .nav-pills .nav-link.active {
            background-color: var(--primary-color);
        }
        
        .nav-pills .nav-link {
            color: var(--text-color);
            margin-right: 10px;
            margin-bottom: 10px;
            border-radius: 20px;
        }
        
        .crop-card {
            border: 2px solid #e0e0e0;
            border-radius: 12px;
            padding: 15px;
            cursor: pointer;
            transition: all 0.3s ease;
            background: white;
        }
        
        .crop-card:hover {
            border-color: var(--primary-color);
            box-shadow: 0 3px 10px rgba(46, 204, 113, 0.2);
        }
        
        .crop-card.selected {
            border-color: var(--primary-color);
            background-color: #e8f8f5;
        }

        .api-card {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border-radius: 15px;
            padding: 20px;
            margin-bottom: 15px;
        }

        .api-card .icon {
            font-size: 2.5rem;
            margin-bottom: 10px;
        }

        .data-table {
            font-size: 0.9rem;
        }

        .data-table th {
            background: rgba(46, 204, 113, 0.1);
            font-weight: 600;
        }

        .price-up {
            color: #27ae60;
        }

        .price-down {
            color: #e74c3c;
        }

        .loading-spinner {
            display: none;
            text-align: center;
            padding: 40px;
        }

        .loading-spinner.active {
            display: block;
        }

        .api-badge {
            background: linear-gradient(135deg, #11998e, #38ef7d);
            color: white;
            padding: 5px 15px;
            border-radius: 20px;
            font-size: 0.8rem;
            display: inline-block;
            margin-bottom: 10px;
        }

        .stat-box {
            background: white;
            border-radius: 12px;
            padding: 20px;
            text-align: center;
            box-shadow: 0 3px 10px rgba(0,0,0,0.08);
            transition: transform 0.3s ease;
        }

        .stat-box:hover {
            transform: translateY(-3px);
        }

        .stat-box .value {
            font-size: 1.8rem;
            font-weight: 700;
            color: var(--secondary-color);
        }

        .stat-box .label {
            color: #7f8c8d;
            font-size: 0.9rem;
        }

        .province-select {
            max-width: 300px;
        }
    </style>
</head>
<body>

    <div class="header text-center position-relative">
        <a href="calculator.html" class="btn btn-light position-absolute top-0 start-0 m-3 rounded-circle shadow-sm" style="width: 45px; height: 45px; display: flex; align-items: center; justify-content: center; z-index: 10;" title="‡∏Å‡∏•‡∏±‡∏ö‡∏´‡∏ô‡πâ‡∏≤‡∏´‡∏•‡∏±‡∏Å">
            <i class="fas fa-home text-success"></i>
        </a>
        <div class="container">
            <h1><i class="fas fa-seedling"></i> WIT 365 ‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏°‡∏∑‡∏≠‡πÄ‡∏Å‡∏©‡∏ï‡∏£‡∏≠‡∏±‡∏à‡∏â‡∏£‡∏¥‡∏¢‡∏∞</h1>
            <p class="lead">‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏°‡∏∑‡∏≠‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡πÄ‡∏Å‡∏©‡∏ï‡∏£‡∏≠‡∏±‡∏à‡∏â‡∏£‡∏¥‡∏¢‡∏∞‡πÅ‡∏ö‡∏ö‡∏Ñ‡∏£‡∏ö‡∏ß‡∏á‡∏à‡∏£ - ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏Ñ‡∏ô‡πÑ‡∏ó‡∏¢</p>
        </div>
    </div>

    <div class="container mb-5">
        <ul class="nav nav-pills mb-4 justify-content-center flex-wrap" id="pills-tab" role="tablist">
            <li class="nav-item" role="presentation">
                <button class="nav-link active" id="pills-fertilizer-tab" data-bs-toggle="pill" data-bs-target="#pills-fertilizer" type="button" role="tab"><i class="fas fa-flask"></i> ‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏õ‡∏∏‡πã‡∏¢</button>
            </li>
            <li class="nav-item" role="presentation">
                <button class="nav-link" id="pills-crop-tab" data-bs-toggle="pill" data-bs-target="#pills-crop" type="button" role="tab"><i class="fas fa-leaf"></i> ‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥‡∏™‡∏π‡∏ï‡∏£</button>
            </li>
            <li class="nav-item" role="presentation">
                <button class="nav-link" id="pills-cost-tab" data-bs-toggle="pill" data-bs-target="#pills-cost" type="button" role="tab"><i class="fas fa-coins"></i> ‡∏ï‡πâ‡∏ô‡∏ó‡∏∏‡∏ô-‡∏ú‡∏•‡∏ï‡∏≠‡∏ö‡πÅ‡∏ó‡∏ô</button>
            </li>
            <li class="nav-item" role="presentation">
                <button class="nav-link" id="pills-area-tab" data-bs-toggle="pill" data-bs-target="#pills-area" type="button" role="tab"><i class="fas fa-map-marked-alt"></i> ‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà & ‡∏Å‡∏≤‡∏£‡∏õ‡∏•‡∏π‡∏Å</button>
            </li>
            <li class="nav-item" role="presentation">
                <button class="nav-link" id="pills-water-tab" data-bs-toggle="pill" data-bs-target="#pills-water" type="button" role="tab"><i class="fas fa-tint"></i> ‡∏£‡∏∞‡∏ö‡∏ö‡∏ô‡πâ‡∏≥</button>
            </li>
            <li class="nav-item" role="presentation">
                <button class="nav-link" id="pills-calendar-tab" data-bs-toggle="pill" data-bs-target="#pills-calendar" type="button" role="tab"><i class="fas fa-calendar-alt"></i> ‡∏õ‡∏è‡∏¥‡∏ó‡∏¥‡∏ô‡πÄ‡∏Å‡∏©‡∏ï‡∏£</button>
            </li>
            <li class="nav-item" role="presentation">
                <button class="nav-link" id="pills-nabc-tab" data-bs-toggle="pill" data-bs-target="#pills-nabc" type="button" role="tab"><i class="fas fa-database"></i> ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• NABC</button>
            </li>
        </ul>

        <div class="tab-content" id="pills-tabContent">
            
            <!-- 1. Advanced Fertilizer Calculator -->
            <div class="tab-pane fade show active" id="pills-fertilizer" role="tabpanel">
                <div class="row justify-content-center">
                    <div class="col-md-10">
                        <div class="card">
                            <div class="card-header">
                                <i class="fas fa-calculator"></i> ‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏™‡∏π‡∏ï‡∏£‡∏õ‡∏∏‡πã‡∏¢‡∏ú‡∏™‡∏°‡πÅ‡∏ö‡∏ö‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î (NPK + ‡∏ò‡∏≤‡∏ï‡∏∏‡∏£‡∏≠‡∏á + ‡πÑ‡∏°‡πÇ‡∏Ñ‡∏£)
                            </div>
                            <div class="card-body">
                                <div class="row mb-3">
                                    <div class="col-md-4">
                                        <label class="form-label"><strong>‡∏™‡∏π‡∏ï‡∏£‡∏õ‡∏∏‡πã‡∏¢‡∏´‡∏•‡∏±‡∏Å (N-P-K %)</strong></label>
                                        <div class="input-group">
                                            <input type="number" class="form-control" id="targetN" placeholder="N" value="15">
                                            <input type="number" class="form-control" id="targetP" placeholder="P" value="15">
                                            <input type="number" class="form-control" id="targetK" placeholder="K" value="15">
                                        </div>
                                    </div>
                                    <div class="col-md-4">
                                        <label class="form-label">‡∏ò‡∏≤‡∏ï‡∏∏‡∏£‡∏≠‡∏á (Ca-Mg-S %)</label>
                                        <div class="input-group">
                                            <input type="number" class="form-control" id="targetCa" placeholder="Ca" value="0">
                                            <input type="number" class="form-control" id="targetMg" placeholder="Mg" value="0">
                                            <input type="number" class="form-control" id="targetS" placeholder="S" value="0">
                                        </div>
                                    </div>
                                    <div class="col-md-4">
                                        <label class="form-label">‡∏õ‡∏£‡∏¥‡∏°‡∏≤‡∏ì‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£ (‡∏Å‡∏Å.)</label>
                                        <input type="number" class="form-control" id="targetWeight" placeholder="‡∏£‡∏∞‡∏ö‡∏∏‡∏ô‡πâ‡∏≥‡∏´‡∏ô‡∏±‡∏Å" value="100">
                                        <small class="text-muted d-block mt-1">‡∏£‡∏≤‡∏Ñ‡∏≤‡∏£‡∏ß‡∏°‡∏õ‡∏£‡∏∞‡∏°‡∏≤‡∏ì: <span id="fertCost" class="fw-bold text-success">0</span> ‡∏ö‡∏≤‡∏ó</small>
                                    </div>
                                </div>
                                <div class="mb-3">
                                    <label class="form-label">‡πÅ‡∏°‡πà‡∏õ‡∏∏‡πã‡∏¢‡∏ó‡∏µ‡πà‡∏°‡∏µ</label>
                                    <div class="row">
                                        <div class="col-md-3">
                                            <div class="form-check">
                                                <input class="form-check-input" type="checkbox" checked disabled>
                                                <label class="form-check-label">Urea (46-0-0) <small class="text-muted">12 ‡∏ö/‡∏Å‡∏Å.</small></label>
                                            </div>
                                        </div>
                                        <div class="col-md-3">
                                            <div class="form-check">
                                                <input class="form-check-input" type="checkbox" checked disabled>
                                                <label class="form-check-label">DAP (18-46-0) <small class="text-muted">18 ‡∏ö/‡∏Å‡∏Å.</small></label>
                                            </div>
                                        </div>
                                        <div class="col-md-3">
                                            <div class="form-check">
                                                <input class="form-check-input" type="checkbox" checked disabled>
                                                <label class="form-check-label">MOP (0-0-60) <small class="text-muted">15 ‡∏ö/‡∏Å‡∏Å.</small></label>
                                            </div>
                                        </div>
                                        <div class="col-md-3">
                                            <div class="form-check">
                                                <input class="form-check-input" type="checkbox" id="useDolomite">
                                                <label class="form-check-label">Dolomite (Ca+Mg) <small class="text-muted">8 ‡∏ö/‡∏Å‡∏Å.</small></label>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <button class="btn btn-calc" onclick="calculateFertilizerAdvanced()">‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏™‡πà‡∏ß‡∏ô‡∏ú‡∏™‡∏°‡πÅ‡∏ö‡∏ö‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î</button>
                                
                                <div class="result-box" id="fertilizerResult">
                                    <h5><i class="fas fa-check-circle"></i> ‡∏ú‡∏•‡∏Å‡∏≤‡∏£‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì</h5>
                                    <div id="fertilizerDetails"></div>
                                    <div class="mt-3 p-3 bg-white rounded">
                                        <strong><i class="fas fa-lightbulb text-warning"></i> ‡∏Ñ‡∏≥‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥:</strong>
                                        <ul class="mb-0 mt-2" id="fertTips">
                                            <li>‡∏ú‡∏™‡∏°‡πÉ‡∏´‡πâ‡πÄ‡∏Ç‡πâ‡∏≤‡∏Å‡∏±‡∏ô‡∏Å‡πà‡∏≠‡∏ô‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô</li>
                                            <li>‡πÄ‡∏Å‡πá‡∏ö‡πÉ‡∏ô‡∏ó‡∏µ‡πà‡πÅ‡∏´‡πâ‡∏á ‡∏£‡πà‡∏°‡πÄ‡∏¢‡πá‡∏ô ‡∏´‡∏•‡∏µ‡∏Å‡πÄ‡∏•‡∏µ‡πà‡∏¢‡∏á‡πÅ‡∏™‡∏á‡πÅ‡∏î‡∏î</li>
                                            <li>‡πÉ‡∏ä‡πâ‡∏†‡∏≤‡∏¢‡πÉ‡∏ô 6 ‡πÄ‡∏î‡∏∑‡∏≠‡∏ô‡∏´‡∏•‡∏±‡∏á‡∏ú‡∏™‡∏°</li>
                                        </ul>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- 2. Crop Recommendation System -->
            <div class="tab-pane fade" id="pills-crop" role="tabpanel">
                <div class="row justify-content-center">
                    <div class="col-md-10">
                        <div class="card">
                            <div class="card-header">
                                <i class="fas fa-leaf"></i> ‡∏£‡∏∞‡∏ö‡∏ö‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥‡∏™‡∏π‡∏ï‡∏£‡∏õ‡∏∏‡πã‡∏¢‡∏ï‡∏≤‡∏°‡∏û‡∏∑‡∏ä
                            </div>
                            <div class="card-body">
                                <div class="mb-3">
                                    <label class="form-label"><strong>‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡∏û‡∏∑‡∏ä:</strong></label>
                                </div>
                                <div class="row g-3" id="cropSelector">
                                    <!-- Cards generated by JS -->
                                </div>
                                <div class="result-box mt-3" id="cropRecommendResult" style="display:block;">
                                    <div id="cropRecommendDetails">
                                        <p class="text-center text-muted"><i class="fas fa-hand-pointer"></i> ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏û‡∏∑‡∏ä‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏î‡∏π‡∏Ñ‡∏≥‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥</p>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- 3. Cost-Benefit Analysis -->
            <div class="tab-pane fade" id="pills-cost" role="tabpanel">
                <div class="row justify-content-center">
                    <div class="col-md-10">
                        <div class="card">
                            <div class="card-header">
                                <i class="fas fa-chart-pie"></i> ‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå‡∏ï‡πâ‡∏ô‡∏ó‡∏∏‡∏ô‡πÅ‡∏•‡∏∞‡∏ú‡∏•‡∏ï‡∏≠‡∏ö‡πÅ‡∏ó‡∏ô (ROI Calculator)
                            </div>
                            <div class="card-body">
                                <div class="row mb-3">
                                    <div class="col-md-6">
                                        <label class="form-label"><strong>‡∏ï‡πâ‡∏ô‡∏ó‡∏∏‡∏ô‡∏Ñ‡∏á‡∏ó‡∏µ‡πà</strong></label>
                                        <div class="mb-2">
                                            <label class="small">‡∏Ñ‡πà‡∏≤‡∏ó‡∏µ‡πà‡∏î‡∏¥‡∏ô/‡πÄ‡∏ä‡πà‡∏≤ (‡∏ö‡∏≤‡∏ó/‡∏õ‡∏µ)</label>
                                            <input type="number" class="form-control" id="landCost" value="0">
                                        </div>
                                        <div class="mb-2">
                                            <label class="small">‡πÇ‡∏£‡∏á‡πÄ‡∏£‡∏∑‡∏≠‡∏ô/‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå (‡∏ö‡∏≤‡∏ó)</label>
                                            <input type="number" class="form-control" id="equipmentCost" value="0">
                                        </div>
                                        <div class="mb-2">
                                            <label class="small">‡∏Ñ‡πà‡∏≤‡πÑ‡∏ü‡∏ü‡πâ‡∏≤/‡∏ô‡πâ‡∏≥ (‡∏ö‡∏≤‡∏ó/‡πÄ‡∏î‡∏∑‡∏≠‡∏ô)</label>
                                            <input type="number" class="form-control" id="utilityCost" value="0">
                                        </div>
                                    </div>
                                    <div class="col-md-6">
                                        <label class="form-label"><strong>‡∏ï‡πâ‡∏ô‡∏ó‡∏∏‡∏ô‡∏ú‡∏±‡∏ô‡πÅ‡∏õ‡∏£ (‡∏ï‡πà‡∏≠‡∏£‡∏≠‡∏ö‡∏Å‡∏≤‡∏£‡πÄ‡∏û‡∏≤‡∏∞‡∏õ‡∏•‡∏π‡∏Å)</strong></label>
                                        <div class="mb-2">
                                            <label class="small">‡∏û‡∏±‡∏ô‡∏ò‡∏∏‡πå‡∏û‡∏∑‡∏ä/‡∏Å‡∏•‡πâ‡∏≤ (‡∏ö‡∏≤‡∏ó)</label>
                                            <input type="number" class="form-control" id="seedCost" value="0">
                                        </div>
                                        <div class="mb-2">
                                            <label class="small">‡∏õ‡∏∏‡πã‡∏¢/‡∏¢‡∏≤ (‡∏ö‡∏≤‡∏ó)</label>
                                            <input type="number" class="form-control" id="fertilCost2" value="0">
                                        </div>
                                        <div class="mb-2">
                                            <label class="small">‡∏Ñ‡πà‡∏≤‡πÅ‡∏£‡∏á‡∏á‡∏≤‡∏ô (‡∏ö‡∏≤‡∏ó)</label>
                                            <input type="number" class="form-control" id="laborCost" value="0">
                                        </div>
                                    </div>
                                </div>
                                <div class="row mb-3">
                                    <div class="col-md-4">
                                        <label class="form-label">‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏£‡∏≠‡∏ö‡∏ï‡πà‡∏≠‡∏õ‡∏µ</label>
                                        <input type="number" class="form-control" id="cyclePerYear" value="2">
                                    </div>
                                    <div class="col-md-4">
                                        <label class="form-label">‡∏ú‡∏•‡∏ú‡∏•‡∏¥‡∏ï‡πÄ‡∏â‡∏•‡∏µ‡πà‡∏¢ (‡∏Å‡∏Å./‡∏£‡∏≠‡∏ö)</label>
                                        <input type="number" class="form-control" id="expectedYield2" value="1000">
                                    </div>
                                    <div class="col-md-4">
                                        <label class="form-label">‡∏£‡∏≤‡∏Ñ‡∏≤‡∏Ç‡∏≤‡∏¢ (‡∏ö‡∏≤‡∏ó/‡∏Å‡∏Å.)</label>
                                        <input type="number" class="form-control" id="sellingPrice2" value="50">
                                    </div>
                                </div>
                                <button class="btn btn-calc" onclick="calculateCostBenefit()">‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå‡∏Ñ‡∏ß‡∏≤‡∏°‡∏Ñ‡∏∏‡πâ‡∏°‡∏Ñ‡πà‡∏≤</button>
                                <div class="result-box" id="costResult">
                                    <div id="costDetails"></div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- 4. Area & Planting Calculator -->
            <div class="tab-pane fade" id="pills-area" role="tabpanel">
                <div class="row">
                    <div class="col-md-6">
                        <div class="card">
                            <div class="card-header">
                                <i class="fas fa-ruler-combined"></i> ‡πÅ‡∏õ‡∏•‡∏á‡∏´‡∏ô‡πà‡∏ß‡∏¢‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà
                            </div>
                            <div class="card-body">
                                <div class="mb-3">
                                    <label class="form-label">‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡πÑ‡∏£‡πà-‡∏á‡∏≤‡∏ô-‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡∏ß‡∏≤</label>
                                    <div class="input-group mb-2">
                                        <input type="number" class="form-control" id="rai" placeholder="‡πÑ‡∏£‡πà" value="1">
                                        <input type="number" class="form-control" id="ngan" placeholder="‡∏á‡∏≤‡∏ô" value="0">
                                        <input type="number" class="form-control" id="wah" placeholder="‡∏ï‡∏£.‡∏ß‡∏≤" value="0">
                                    </div>
                                </div>
                                <button class="btn btn-calc" onclick="convertArea()">‡πÅ‡∏õ‡∏•‡∏á‡∏´‡∏ô‡πà‡∏ß‡∏¢</button>
                                <div class="result-box" id="areaResult">
                                    <div id="areaDetails"></div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-6">
                        <div class="card">
                            <div class="card-header">
                                <i class="fas fa-tree"></i> ‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏ï‡πâ‡∏ô‡πÑ‡∏°‡πâ
                            </div>
                            <div class="card-body">
                                <div class="row mb-3">
                                    <div class="col-6">
                                        <label class="form-label">‡∏£‡∏∞‡∏¢‡∏∞‡∏£‡∏∞‡∏´‡∏ß‡πà‡∏≤‡∏á‡∏ï‡πâ‡∏ô (‡∏°.)</label>
                                        <input type="number" class="form-control" id="plantSpace" value="2">
                                    </div>
                                    <div class="col-6">
                                        <label class="form-label">‡∏£‡∏∞‡∏¢‡∏∞‡∏£‡∏∞‡∏´‡∏ß‡πà‡∏≤‡∏á‡πÅ‡∏ñ‡∏ß (‡∏°.)</label>
                                        <input type="number" class="form-control" id="rowSpace" value="2">
                                    </div>
                                </div>
                                <div class="mb-3">
                                    <label class="form-label">‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà‡∏õ‡∏•‡∏π‡∏Å (‡πÑ‡∏£‡πà)</label>
                                    <input type="number" class="form-control" id="plantArea" value="1">
                                </div>
                                <button class="btn btn-calc" onclick="calculatePlants()">‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏ï‡πâ‡∏ô</button>
                                <div class="result-box" id="plantResult">
                                    <h4 class="text-center text-success" id="plantCount">0 ‡∏ï‡πâ‡∏ô</h4>
                                    <p class="text-center small text-muted mb-0">‡∏Ñ‡∏ß‡∏≤‡∏°‡∏´‡∏ô‡∏≤‡πÅ‡∏ô‡πà‡∏ô: <span id="plantDensity">0</span> ‡∏ï‡πâ‡∏ô/‡πÑ‡∏£‡πà</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- 5. Water System Calculator -->
            <div class="tab-pane fade" id="pills-water" role="tabpanel">
                <div class="row justify-content-center">
                    <div class="col-md-8">
                        <div class="card">
                            <div class="card-header">
                                <i class="fas fa-tint"></i> ‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏ô‡πâ‡∏≥‡πÅ‡∏ö‡∏ö‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î (ETc Method)
                            </div>
                            <div class="card-body">
                                <div class="mb-3">
                                    <label class="form-label">‡∏ä‡∏ô‡∏¥‡∏î‡∏û‡∏∑‡∏ä (‡∏Ñ‡πà‡∏≤ Kc)</label>
                                    <select class="form-select" id="cropType">
                                        <option value="0.8">‡∏û‡∏∑‡∏ä‡∏ú‡∏±‡∏Å (Kc = 0.8)</option>
                                        <option value="1.0" selected>‡∏û‡∏∑‡∏ä‡πÑ‡∏£‡πà‡∏ó‡∏±‡πà‡∏ß‡πÑ‡∏õ (Kc = 1.0)</option>
                                        <option value="1.1">‡∏õ‡∏≤‡∏•‡πå‡∏°‡∏ô‡πâ‡∏≥‡∏°‡∏±‡∏ô (Kc = 1.1)</option>
                                        <option value="1.2">‡πÑ‡∏°‡πâ‡∏ú‡∏• - ‡∏ó‡∏∏‡πÄ‡∏£‡∏µ‡∏¢‡∏ô/‡∏°‡∏±‡∏á‡∏Ñ‡∏∏‡∏î (Kc = 1.2)</option>
                                        <option value="1.5">‡∏Ç‡πâ‡∏≤‡∏ß (Kc = 1.5)</option>
                                        <option value="1.3">‡∏≠‡πâ‡∏≠‡∏¢ (Kc = 1.3)</option>
                                    </select>
                                </div>
                                <div class="row mb-3">
                                    <div class="col-md-6">
                                        <label class="form-label">‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà‡∏õ‡∏•‡∏π‡∏Å (‡πÑ‡∏£‡πà)</label>
                                        <input type="number" class="form-control" id="waterArea" value="1">
                                    </div>
                                    <div class="col-md-6">
                                        <label class="form-label">‡∏Å‡∏≤‡∏£‡∏£‡∏∞‡πÄ‡∏´‡∏¢‡∏ô‡πâ‡∏≥ ET0 (mm/‡∏ß‡∏±‡∏ô)</label>
                                        <input type="number" class="form-control" id="evaporation" value="5" placeholder="‡∏Ñ‡πà‡∏≤‡πÄ‡∏â‡∏•‡∏µ‡πà‡∏¢ 4-6">
                                    </div>
                                </div>
                                <div class="mb-3">
                                    <label class="form-label">‡∏õ‡∏£‡∏∞‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡∏†‡∏≤‡∏û‡∏£‡∏∞‡∏ö‡∏ö‡∏ô‡πâ‡∏≥ (%)</label>
                                    <select class="form-select" id="irrigationEfficiency">
                                        <option value="0.9">‡∏£‡∏∞‡∏ö‡∏ö‡∏ô‡πâ‡∏≥‡∏´‡∏¢‡∏î (90%)</option>
                                        <option value="0.75">‡∏™‡∏õ‡∏£‡∏¥‡∏á‡πÄ‡∏Å‡∏•‡∏≠‡∏£‡πå (75%)</option>
                                        <option value="0.6" selected>‡∏ó‡πà‡∏≠‡∏ô‡πâ‡∏≥‡∏ó‡∏±‡πà‡∏ß‡πÑ‡∏õ (60%)</option>
                                        <option value="0.4">‡∏ô‡πâ‡∏≥‡∏ó‡πà‡∏ß‡∏°‡∏ò‡∏£‡∏£‡∏°‡∏ä‡∏≤‡∏ï‡∏¥ (40%)</option>
                                    </select>
                                </div>
                                <button class="btn btn-calc" onclick="calculateWater()">‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏õ‡∏£‡∏¥‡∏°‡∏≤‡∏ì‡∏ô‡πâ‡∏≥</button>
                                <div class="result-box" id="waterResult">
                                    <div class="row text-center">
                                        <div class="col-4">
                                            <h6>‡∏ï‡πà‡∏≠‡∏ß‡∏±‡∏ô</h6>
                                            <h4 class="text-primary" id="waterDaily">0 ‡∏•‡∏¥‡∏ï‡∏£</h4>
                                        </div>
                                        <div class="col-4">
                                            <h6>‡∏ï‡πà‡∏≠‡πÄ‡∏î‡∏∑‡∏≠‡∏ô</h6>
                                            <h4 class="text-info" id="waterMonthly">0 ‡∏•‡∏ö.‡∏°.</h4>
                                        </div>
                                        <div class="col-4">
                                            <h6>‡∏ï‡πà‡∏≠‡∏õ‡∏µ</h6>
                                            <h4 class="text-success" id="waterYearly">0 ‡∏•‡∏ö.‡∏°.</h4>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- 6. Planting Calendar -->
            <div class="tab-pane fade" id="pills-calendar" role="tabpanel">
                <div class="row justify-content-center">
                    <div class="col-md-10">
                        <div class="card">
                            <div class="card-header">
                                <i class="fas fa-calendar-check"></i> ‡∏õ‡∏è‡∏¥‡∏ó‡∏¥‡∏ô‡πÄ‡∏Å‡∏©‡∏ï‡∏£‡∏Å‡∏£‡∏£‡∏° - ‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥‡∏ä‡πà‡∏ß‡∏á‡πÄ‡∏ß‡∏•‡∏≤‡πÄ‡∏û‡∏≤‡∏∞‡∏õ‡∏•‡∏π‡∏Å
                            </div>
                            <div class="card-body">
                                <div class="mb-3">
                                    <label class="form-label"><strong>‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏†‡∏π‡∏°‡∏¥‡∏†‡∏≤‡∏Ñ:</strong></label>
                                    <select class="form-select" id="regionSelect" onchange="updateCalendar()">
                                        <option value="north">‡∏†‡∏≤‡∏Ñ‡πÄ‡∏´‡∏ô‡∏∑‡∏≠</option>
                                        <option value="northeast" selected>‡∏†‡∏≤‡∏Ñ‡∏≠‡∏µ‡∏™‡∏≤‡∏ô</option>
                                        <option value="central">‡∏†‡∏≤‡∏Ñ‡∏Å‡∏•‡∏≤‡∏á</option>
                                        <option value="south">‡∏†‡∏≤‡∏Ñ‡πÉ‡∏ï‡πâ</option>
                                    </select>
                                </div>
                                <div id="calendarDisplay">
                                    <div class="table-responsive">
                                        <table class="table table-bordered">
                                            <thead class="table-light">
                                                <tr>
                                                    <th>‡∏û‡∏∑‡∏ä</th>
                                                    <th>‡∏ä‡πà‡∏ß‡∏á‡∏õ‡∏•‡∏π‡∏Å‡∏ó‡∏µ‡πà‡∏î‡∏µ</th>
                                                    <th>‡πÄ‡∏Å‡πá‡∏ö‡πÄ‡∏Å‡∏µ‡πà‡∏¢‡∏ß</th>
                                                    <th>‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏</th>
                                                </tr>
                                            </thead>
                                            <tbody id="calendarBody">
                                                <!-- Generated by JS -->
                                            </tbody>
                                        </table>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- 7. NABC API Data -->
            <div class="tab-pane fade" id="pills-nabc" role="tabpanel">
                <div class="row justify-content-center">
                    <div class="col-12">
                        <!-- API Header -->
                        <div class="api-card text-center mb-4">
                            <div class="icon"><i class="fas fa-satellite-dish"></i></div>
                            <h4>‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏Å‡∏©‡∏ï‡∏£‡∏à‡∏≤‡∏Å NABC API</h4>
                            <p class="mb-2">‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠‡∏Å‡∏±‡∏ö ‡∏™‡∏≥‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô‡πÄ‡∏®‡∏£‡∏©‡∏ê‡∏Å‡∏¥‡∏à‡∏Å‡∏≤‡∏£‡πÄ‡∏Å‡∏©‡∏ï‡∏£ (‡∏™‡∏®‡∏Å.)</p>
                            <span class="api-badge"><i class="fas fa-link"></i> agriapi.nabc.go.th</span>
                        </div>

                        <!-- Loading Spinner -->
                        <div class="loading-spinner" id="nabcLoading">
                            <div class="spinner-border text-success" role="status">
                                <span class="visually-hidden">Loading...</span>
                            </div>
                            <p class="mt-2">‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•...</p>
                        </div>

                        <!-- Filters -->
                        <div class="card mb-4">
                            <div class="card-header">
                                <i class="fas fa-filter"></i> ‡∏ï‡∏±‡∏ß‡∏Å‡∏£‡∏≠‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•
                            </div>
                            <div class="card-body">
                                <div class="row g-3">
                                    <div class="col-md-4">
                                        <label class="form-label">‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏±‡∏î</label>
                                        <select class="form-select province-select" id="nabcProvince">
                                            <option value="">‡∏ó‡∏±‡πâ‡∏á‡∏õ‡∏£‡∏∞‡πÄ‡∏ó‡∏®</option>
                                        </select>
                                    </div>
                                    <div class="col-md-4">
                                        <label class="form-label">‡∏õ‡∏µ‡∏Å‡∏≤‡∏£‡∏ú‡∏•‡∏¥‡∏ï</label>
                                        <select class="form-select" id="nabcYear">
                                            <option value="2568">2568</option>
                                            <option value="2567" selected>2567</option>
                                            <option value="2566">2566</option>
                                            <option value="2565">2565</option>
                                            <option value="2564">2564</option>
                                        </select>
                                    </div>
                                    <div class="col-md-4 d-flex align-items-end">
                                        <button class="btn btn-calc" onclick="refreshNABCData()">
                                            <i class="fas fa-sync-alt"></i> ‡∏£‡∏µ‡πÄ‡∏ü‡∏£‡∏ä‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Crop Selection Cards -->
                        <div class="card mb-4">
                            <div class="card-header">
                                <i class="fas fa-seedling"></i> ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏û‡∏∑‡∏ä‡πÄ‡∏®‡∏£‡∏©‡∏ê‡∏Å‡∏¥‡∏à
                            </div>
                            <div class="card-body">
                                <div class="row g-3" id="nabcCropCards">
                                    <!-- Generated by JS -->
                                </div>
                            </div>
                        </div>

                        <!-- Production Summary -->
                        <div id="nabcSummary">
                            <!-- Generated by JS -->
                        </div>

                        <!-- Crop Details (hidden until selected) -->
                        <div id="nabcCropDetails" style="display: none;">
                            <!-- Generated by JS -->
                        </div>

                        <!-- Price Data Section -->
                        <div class="card mt-4">
                            <div class="card-header">
                                <i class="fas fa-chart-line"></i> ‡∏£‡∏≤‡∏Ñ‡∏≤‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡πÄ‡∏Å‡∏©‡∏ï‡∏£
                            </div>
                            <div class="card-body">
                                <div class="row mb-3">
                                    <div class="col-md-4">
                                        <label class="form-label">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤</label>
                                        <select class="form-select" id="nabcPriceCrop">
                                            <option value="rice">‡∏Ç‡πâ‡∏≤‡∏ß‡πÄ‡∏õ‡∏•‡∏∑‡∏≠‡∏Å‡πÄ‡∏à‡πâ‡∏≤</option>
                                            <option value="sugarcane">‡∏≠‡πâ‡∏≠‡∏¢</option>
                                            <option value="cassava">‡∏°‡∏±‡∏ô‡∏™‡∏≥‡∏õ‡∏∞‡∏´‡∏•‡∏±‡∏á</option>
                                            <option value="corn">‡∏Ç‡πâ‡∏≤‡∏ß‡πÇ‡∏û‡∏î‡πÄ‡∏•‡∏µ‡πâ‡∏¢‡∏á‡∏™‡∏±‡∏ï‡∏ß‡πå</option>
                                            <option value="rubber">‡∏¢‡∏≤‡∏á‡∏û‡∏≤‡∏£‡∏≤‡πÅ‡∏ú‡πà‡∏ô</option>
                                            <option value="palm">‡∏õ‡∏≤‡∏•‡πå‡∏°‡∏ô‡πâ‡∏≥‡∏°‡∏±‡∏ô</option>
                                        </select>
                                    </div>
                                    <div class="col-md-4 d-flex align-items-end">
                                        <button class="btn btn-calc" onclick="fetchNABCPriceData()">
                                            <i class="fas fa-search"></i> ‡∏î‡∏π‡∏£‡∏≤‡∏Ñ‡∏≤
                                        </button>
                                    </div>
                                </div>
                                <div id="nabcPriceChart">
                                    <p class="text-center text-muted"><i class="fas fa-chart-area"></i> ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏î‡∏π‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏£‡∏≤‡∏Ñ‡∏≤</p>
                                </div>
                            </div>
                        </div>

                        <!-- API Info Footer -->
                        <div class="alert alert-info mt-4">
                            <i class="fas fa-info-circle"></i>
                            <strong>‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏:</strong> ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏≤‡∏Å NABC Agriculture API - Production API
                            <br><small>‡πÅ‡∏´‡∏•‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•: <a href="https://agriapi.nabc.go.th/home/production-api" target="_blank" rel="noopener noreferrer">https://agriapi.nabc.go.th/home/production-api</a></small>
                            <br><small>* ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡∏™‡∏≤‡∏ò‡∏¥‡∏ï - ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô API Key ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡∏à‡∏£‡∏¥‡∏á</small>
                        </div>
                    </div>
                </div>
            </div>

        </div>
    </div>

    <script>
        // Crop Database
        const CROP_DATABASE = {
            rice: {
                name: '‡∏Ç‡πâ‡∏≤‡∏ß',
                icon: 'fas fa-wheat-awn',
                npk: '16-20-0',
                notes: '‡πÉ‡∏™‡πà‡∏õ‡∏∏‡πã‡∏¢‡πÅ‡∏ö‡πà‡∏á 3 ‡∏Ñ‡∏£‡∏±‡πâ‡∏á: ‡∏Å‡πà‡∏≠‡∏ô‡∏õ‡∏±‡∏Å‡∏î‡∏≥, ‡∏£‡∏∞‡∏¢‡∏∞‡πÅ‡∏ï‡∏Å‡∏Å‡∏≠, ‡∏£‡∏∞‡∏¢‡∏∞‡∏≠‡∏≠‡∏Å‡∏î‡∏≠‡∏Å',
                ratePerRai: '50-60 ‡∏Å‡∏Å./‡πÑ‡∏£‡πà',
                timing: '‡∏û.‡∏Ñ.-‡∏°‡∏¥.‡∏¢. (‡∏ô‡∏≤‡∏õ‡∏µ), ‡∏û.‡∏¢.-‡∏ò.‡∏Ñ. (‡∏ô‡∏≤‡∏õ‡∏£‡∏±‡∏á)'
            },
            corn: {
                name: '‡∏Ç‡πâ‡∏≤‡∏ß‡πÇ‡∏û‡∏î',
                icon: 'fas fa-corn',
                npk: '15-15-15',
                notes: '‡πÉ‡∏™‡πà‡∏£‡∏≠‡∏á‡∏û‡∏∑‡πâ‡∏ô + ‡πÉ‡∏™‡πà‡∏ï‡∏≤‡∏°‡∏´‡∏•‡∏±‡∏á‡∏õ‡∏•‡∏π‡∏Å 30 ‡∏ß‡∏±‡∏ô',
                ratePerRai: '40-50 ‡∏Å‡∏Å./‡πÑ‡∏£‡πà',
                timing: '‡πÄ‡∏°.‡∏¢.-‡∏°‡∏¥.‡∏¢.'
            },
            cassava: {
                name: '‡∏°‡∏±‡∏ô‡∏™‡∏≥‡∏õ‡∏∞‡∏´‡∏•‡∏±‡∏á',
                icon: 'fas fa-carrot',
                npk: '13-13-21',
                notes: '‡πÄ‡∏ô‡πâ‡∏ô K ‡∏™‡∏π‡∏á‡∏ä‡πà‡∏ß‡∏¢‡πÉ‡∏´‡πâ‡πÅ‡∏õ‡πâ‡∏á‡∏°‡∏≤‡∏Å',
                ratePerRai: '30-40 ‡∏Å‡∏Å./‡πÑ‡∏£‡πà',
                timing: '‡∏ï.‡∏Ñ.-‡∏û.‡∏¢.'
            },
            durian: {
                name: '‡∏ó‡∏∏‡πÄ‡∏£‡∏µ‡∏¢‡∏ô',
                icon: 'fas fa-apple-alt',
                npk: '12-24-12 + Ca+Mg',
                notes: '‡πÉ‡∏™‡πà‡∏õ‡∏∏‡πã‡∏¢‡∏õ‡∏µ‡∏•‡∏∞ 4 ‡∏Ñ‡∏£‡∏±‡πâ‡∏á, ‡πÄ‡∏û‡∏¥‡πà‡∏° Ca/Mg ‡∏õ‡πâ‡∏≠‡∏á‡∏Å‡∏±‡∏ô‡∏ú‡∏•‡πÅ‡∏ï‡∏Å',
                ratePerRai: '80-100 ‡∏Å‡∏Å./‡πÑ‡∏£‡πà (‡∏ï‡πâ‡∏ô‡πÇ‡∏ï)',
                timing: '‡∏°‡∏µ.‡∏Ñ.-‡πÄ‡∏°.‡∏¢. (‡∏ï‡∏¥‡∏î‡∏î‡∏≠‡∏Å)'
            },
            mango: {
                name: '‡∏°‡∏∞‡∏°‡πà‡∏ß‡∏á',
                icon: 'fas fa-lemon',
                npk: '13-13-21',
                notes: '‡πÄ‡∏ô‡πâ‡∏ô K ‡∏Å‡πà‡∏≠‡∏ô‡∏≠‡∏≠‡∏Å‡∏î‡∏≠‡∏Å ‡πÄ‡∏û‡∏¥‡πà‡∏° Ca ‡∏ä‡πà‡∏ß‡∏á‡∏ú‡∏•‡πÇ‡∏ï',
                ratePerRai: '60-80 ‡∏Å‡∏Å./‡πÑ‡∏£‡πà',
                timing: '‡∏ò.‡∏Ñ.-‡∏°.‡∏Ñ. (‡∏ö‡∏±‡∏á‡∏Ñ‡∏±‡∏ö‡∏î‡∏≠‡∏Å)'
            },
            palm: {
                name: '‡∏õ‡∏≤‡∏•‡πå‡∏°‡∏ô‡πâ‡∏≥‡∏°‡∏±‡∏ô',
                icon: 'fas fa-tree',
                npk: '15-15-15 + Mg+B',
                notes: '‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£ Mg ‡∏™‡∏π‡∏á, ‡πÉ‡∏™‡πà‡∏õ‡∏µ‡∏•‡∏∞ 2-3 ‡∏Ñ‡∏£‡∏±‡πâ‡∏á',
                ratePerRai: '120-150 ‡∏Å‡∏Å./‡πÑ‡∏£‡πà',
                timing: '‡∏ï‡πâ‡∏ô‡∏ù‡∏ô-‡∏Å‡∏•‡∏≤‡∏á‡∏õ‡∏µ'
            },
            sugarcane: {
                name: '‡∏≠‡πâ‡∏≠‡∏¢',
                icon: 'fas fa-candy-cane',
                npk: '16-8-8',
                notes: '‡πÄ‡∏ô‡πâ‡∏ô N ‡πÉ‡∏ô‡∏£‡∏∞‡∏¢‡∏∞‡∏ï‡πâ‡∏ô, ‡∏•‡∏î N ‡∏Å‡πà‡∏≠‡∏ô‡πÄ‡∏Å‡πá‡∏ö‡πÄ‡∏Å‡∏µ‡πà‡∏¢‡∏ß',
                ratePerRai: '50-60 ‡∏Å‡∏Å./‡πÑ‡∏£‡πà',
                timing: '‡∏ï.‡∏Ñ.-‡∏ò.‡∏Ñ.'
            },
            vegetable: {
                name: '‡∏ú‡∏±‡∏Å‡∏ó‡∏±‡πà‡∏ß‡πÑ‡∏õ',
                icon: 'fas fa-leaf',
                npk: '15-15-15',
                notes: '‡πÉ‡∏™‡πà‡∏õ‡∏∏‡πã‡∏¢‡∏ó‡∏∏‡∏Å 7-10 ‡∏ß‡∏±‡∏ô',
                ratePerRai: '30-40 ‡∏Å‡∏Å./‡πÑ‡∏£‡πà',
                timing: '‡∏ï‡∏•‡∏≠‡∏î‡∏õ‡∏µ (‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ï‡∏≤‡∏°‡∏§‡∏î‡∏π)'
            }
        };

        // Planting Calendar Data
        const PLANTING_CALENDAR = {
            northeast: [
                { crop: '‡∏Ç‡πâ‡∏≤‡∏ß (‡∏ô‡∏≤‡∏õ‡∏µ)', plant: '‡∏û.‡∏Ñ.-‡∏°‡∏¥.‡∏¢.', harvest: '‡∏ï.‡∏Ñ.-‡∏û.‡∏¢.', note: '‡∏£‡∏≠‡∏ù‡∏ô‡∏ï‡∏Å' },
                { crop: '‡∏Ç‡πâ‡∏≤‡∏ß (‡∏ô‡∏≤‡∏õ‡∏£‡∏±‡∏á)', plant: '‡∏û.‡∏¢.-‡∏ò.‡∏Ñ.', harvest: '‡∏°‡∏µ.‡∏Ñ.-‡πÄ‡∏°.‡∏¢.', note: '‡∏ï‡πâ‡∏≠‡∏á‡∏°‡∏µ‡∏ô‡πâ‡∏≥‡πÄ‡∏û‡∏µ‡∏¢‡∏á‡∏û‡∏≠' },
                { crop: '‡∏°‡∏±‡∏ô‡∏™‡∏≥‡∏õ‡∏∞‡∏´‡∏•‡∏±‡∏á', plant: '‡∏ï.‡∏Ñ.-‡∏û.‡∏¢.', harvest: '10-12 ‡πÄ‡∏î‡∏∑‡∏≠‡∏ô', note: '‡∏´‡∏•‡∏±‡∏á‡πÄ‡∏Å‡πá‡∏ö‡πÄ‡∏Å‡∏µ‡πà‡∏¢‡∏ß‡∏Ç‡πâ‡∏≤‡∏ß' },
                { crop: '‡∏≠‡πâ‡∏≠‡∏¢', plant: '‡∏ï.‡∏Ñ.-‡∏ò.‡∏Ñ.', harvest: '12-14 ‡πÄ‡∏î‡∏∑‡∏≠‡∏ô', note: '‡∏´‡∏•‡∏±‡∏á‡∏§‡∏î‡∏π‡∏ù‡∏ô' },
                { crop: '‡∏ú‡∏±‡∏Å‡∏Å‡∏≤‡∏î‡∏´‡∏≠‡∏°', plant: '‡∏ï.‡∏Ñ.-‡∏ò.‡∏Ñ.', harvest: '40-50 ‡∏ß‡∏±‡∏ô', note: '‡∏≠‡∏≤‡∏Å‡∏≤‡∏®‡πÄ‡∏¢‡πá‡∏ô' },
            ],
            central: [
                { crop: '‡∏Ç‡πâ‡∏≤‡∏ß', plant: '‡∏û.‡∏Ñ.-‡∏°‡∏¥.‡∏¢.', harvest: '‡∏ï.‡∏Ñ.-‡∏û.‡∏¢.', note: '‡∏´‡∏•‡∏±‡∏á‡∏ù‡∏ô‡∏ï‡∏Å' },
                { crop: '‡∏ú‡∏±‡∏Å‡∏ï‡πà‡∏≤‡∏á‡πÜ', plant: '‡∏ï.‡∏Ñ.-‡∏Å.‡∏û.', harvest: '30-60 ‡∏ß‡∏±‡∏ô', note: '‡∏§‡∏î‡∏π‡πÅ‡∏•‡πâ‡∏á' },
                { crop: '‡∏°‡∏∞‡∏°‡πà‡∏ß‡∏á (‡∏ö‡∏±‡∏á‡∏Ñ‡∏±‡∏ö‡∏î‡∏≠‡∏Å)', plant: '‡∏ò.‡∏Ñ.-‡∏°.‡∏Ñ.', harvest: '‡∏°‡∏µ.‡∏Ñ.-‡πÄ‡∏°.‡∏¢.', note: '‡∏£‡∏∞‡∏ß‡∏±‡∏á‡∏ù‡∏ô‡∏ä‡πà‡∏ß‡∏á‡∏î‡∏≠‡∏Å‡∏ö‡∏≤‡∏ô' },
            ],
            north: [
                { crop: '‡∏Ç‡πâ‡∏≤‡∏ß', plant: '‡∏°‡∏¥.‡∏¢.-‡∏Å.‡∏Ñ.', harvest: '‡∏û.‡∏¢.-‡∏ò.‡∏Ñ.', note: '‡∏´‡∏•‡∏±‡∏á‡∏ù‡∏ô‡∏ï‡∏Å' },
                { crop: '‡∏Å‡∏≤‡πÅ‡∏ü (‡πÄ‡∏Å‡πá‡∏ö‡πÄ‡∏Å‡∏µ‡πà‡∏¢‡∏ß)', plant: '-', harvest: '‡∏ï.‡∏Ñ.-‡∏Å.‡∏û.', note: '‡∏ú‡∏•‡∏™‡∏∏‡∏Å‡πÅ‡∏î‡∏á' },
                { crop: '‡∏™‡∏ï‡∏£‡∏≠‡πÄ‡∏ö‡∏≠‡∏£‡πå‡∏£‡∏µ‡πà', plant: '‡∏Å.‡∏¢.-‡∏ï.‡∏Ñ.', harvest: '‡∏ò.‡∏Ñ.-‡∏Å.‡∏û.', note: '‡∏ó‡∏µ‡πà‡∏™‡∏π‡∏á ‡∏≠‡∏≤‡∏Å‡∏≤‡∏®‡πÄ‡∏¢‡πá‡∏ô' },
            ],
            south: [
                { crop: '‡∏ó‡∏∏‡πÄ‡∏£‡∏µ‡∏¢‡∏ô (‡∏ï‡∏¥‡∏î‡∏î‡∏≠‡∏Å)', plant: '‡∏°‡∏µ.‡∏Ñ.-‡πÄ‡∏°.‡∏¢.', harvest: '‡∏°‡∏¥.‡∏¢.-‡∏™.‡∏Ñ.', note: '‡∏£‡∏∞‡∏ß‡∏±‡∏á‡∏ù‡∏ô‡∏ï‡∏Å‡∏´‡∏ô‡∏±‡∏Å' },
                { crop: '‡∏°‡∏±‡∏á‡∏Ñ‡∏∏‡∏î', plant: '-', harvest: '‡∏û.‡∏Ñ.-‡∏™.‡∏Ñ.', note: '‡∏ú‡∏•‡∏™‡∏∏‡∏Å‡∏°‡πà‡∏ß‡∏á' },
                { crop: '‡∏¢‡∏≤‡∏á‡∏û‡∏≤‡∏£‡∏≤ (‡∏Å‡∏£‡∏µ‡∏î)', plant: '-', harvest: '‡∏ï‡∏•‡∏≠‡∏î‡∏õ‡∏µ', note: '‡∏´‡∏¢‡∏∏‡∏î‡∏Å‡∏£‡∏µ‡∏î‡∏´‡∏≤‡∏Å‡∏ù‡∏ô‡∏ï‡∏Å' },
            ]
        };

        // Initialize crop selector
        function initCropSelector() {
            const container = document.getElementById('cropSelector');
            Object.entries(CROP_DATABASE).forEach(([key, crop]) => {
                const card = `
                    <div class="col-md-4 col-6">
                        <div class="crop-card" onclick="selectCrop('${key}')">
                            <div class="text-center">
                                <i class="${crop.icon} fa-3x text-success mb-2"></i>
                                <h6 class="mb-0">${crop.name}</h6>
                            </div>
                        </div>
                    </div>
                `;
                container.innerHTML += card;
            });
        }

        function selectCrop(cropKey) {
            const crop = CROP_DATABASE[cropKey];
            const result = `
                <h5 class="text-success"><i class="${crop.icon}"></i> ${crop.name}</h5>
                <div class="row mt-3">
                    <div class="col-md-6">
                        <div class="p-3 bg-white rounded mb-2">
                            <strong>‡∏™‡∏π‡∏ï‡∏£‡∏õ‡∏∏‡πã‡∏¢‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥:</strong> <span class="badge bg-success">${crop.npk}</span>
                        </div>
                        <div class="p-3 bg-white rounded mb-2">
                            <strong>‡∏≠‡∏±‡∏ï‡∏£‡∏≤‡πÉ‡∏™‡πà:</strong> ${crop.ratePerRai}
                        </div>
                    </div>
                    <div class="col-md-6">
                        <div class="p-3 bg-white rounded mb-2">
                            <strong>‡∏ä‡πà‡∏ß‡∏á‡πÄ‡∏ß‡∏•‡∏≤‡∏ó‡∏µ‡πà‡πÄ‡∏´‡∏°‡∏≤‡∏∞‡∏™‡∏°:</strong><br>${crop.timing}
                        </div>
                        <div class="p-3 bg-white rounded">
                            <strong>‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏:</strong><br>${crop.notes}
                        </div>
                    </div>
                </div>
                <div class="alert alert-info mt-3 mb-0">
                    <i class="fas fa-info-circle"></i> ‡∏Ñ‡∏≥‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏ï‡∏¥‡∏°: ‡∏Ñ‡∏ß‡∏£‡∏ó‡∏≥‡∏Å‡∏≤‡∏£‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå‡∏î‡∏¥‡∏ô‡∏Å‡πà‡∏≠‡∏ô‡πÉ‡∏™‡πà‡∏õ‡∏∏‡πã‡∏¢‡∏ó‡∏∏‡∏Å‡∏Ñ‡∏£‡∏±‡πâ‡∏á ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏õ‡∏£‡∏±‡∏ö‡∏™‡∏π‡∏ï‡∏£‡πÉ‡∏´‡πâ‡πÄ‡∏´‡∏°‡∏≤‡∏∞‡∏™‡∏°‡∏Å‡∏±‡∏ö‡∏î‡∏¥‡∏ô‡∏Ç‡∏≠‡∏á‡∏ó‡πà‡∏≤‡∏ô
                </div>
            `;
            document.getElementById('cropRecommendDetails').innerHTML = result;
        }

        // Update calendar based on region
        function updateCalendar() {
            const region = document.getElementById('regionSelect').value;
            const data = PLANTING_CALENDAR[region];
            const tbody = document.getElementById('calendarBody');
            tbody.innerHTML = '';
            
            data.forEach(item => {
                const row = `
                    <tr>
                        <td><strong>${item.crop}</strong></td>
                        <td><span class="badge bg-success">${item.plant}</span></td>
                        <td><span class="badge bg-info">${item.harvest}</span></td>
                        <td class="small">${item.note}</td>
                    </tr>
                `;
                tbody.innerHTML += row;
            });
        }

        // Advanced Fertilizer Calculation
        function calculateFertilizerAdvanced() {
            const targetN = parseFloat(document.getElementById('targetN').value) || 0;
            const targetP = parseFloat(document.getElementById('targetP').value) || 0;
            const targetK = parseFloat(document.getElementById('targetK').value) || 0;
            const targetCa = parseFloat(document.getElementById('targetCa').value) || 0;
            const targetMg = parseFloat(document.getElementById('targetMg').value) || 0;
            const targetS = parseFloat(document.getElementById('targetS').value) || 0;
            const weight = parseFloat(document.getElementById('targetWeight').value) || 0;
            const useDolomite = document.getElementById('useDolomite').checked;

            if (weight === 0) {
                alert('‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏£‡∏∞‡∏ö‡∏∏‡∏ô‡πâ‡∏≥‡∏´‡∏ô‡∏±‡∏Å‡∏õ‡∏∏‡πã‡∏¢‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£');
                return;
            }

            // Prices per kg
            const prices = { urea: 12, dap: 18, mop: 15, dolomite: 8 };

            // Calculate main NPK
            const dapRatio = targetP / 46;
            const dapAmount = dapRatio * weight;
            const nFromDap = (dapAmount * 0.18) / weight * 100;
            
            let remainingN = targetN - nFromDap;
            if (remainingN < 0) remainingN = 0;
            const ureaAmount = (remainingN / 46) * weight;
            
            const mopAmount = (targetK / 60) * weight;
            
            // Calculate dolomite for Ca+Mg
            let dolomiteAmount = 0;
            if (useDolomite && (targetCa > 0 || targetMg > 0)) {
                // Dolomite ‡∏°‡∏µ CaMg(CO3)2 ‡∏õ‡∏£‡∏∞‡∏°‡∏≤‡∏ì 20% Ca ‡πÅ‡∏•‡∏∞ 10% Mg
                const caFromDolomite = (targetCa / 20) * weight;
                const mgFromDolomite = (targetMg / 10) * weight;
                dolomiteAmount = Math.max(caFromDolomite, mgFromDolomite);
            }
            
            const totalFertilizer = dapAmount + ureaAmount + mopAmount + dolomiteAmount;
            const filler = weight - totalFertilizer;

            // Calculate cost
            const totalCost = (ureaAmount * prices.urea) + (dapAmount * prices.dap) + 
                            (mopAmount * prices.mop) + (dolomiteAmount * prices.dolomite);

            document.getElementById('fertCost').innerText = totalCost.toFixed(0);

            const resultHtml = `
                <div class="table-responsive">
                    <table class="table table-sm table-bordered">
                        <thead class="table-light">
                            <tr>
                                <th>‡πÅ‡∏°‡πà‡∏õ‡∏∏‡πã‡∏¢</th>
                                <th>‡∏™‡∏π‡∏ï‡∏£</th>
                                <th>‡∏õ‡∏£‡∏¥‡∏°‡∏≤‡∏ì (‡∏Å‡∏Å.)</th>
                                <th>‡∏£‡∏≤‡∏Ñ‡∏≤ (‡∏ö‡∏≤‡∏ó)</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>Urea (‡∏¢‡∏π‡πÄ‡∏£‡∏µ‡∏¢)</td>
                                <td>46-0-0</td>
                                <td class="fw-bold text-primary">${ureaAmount.toFixed(2)}</td>
                                <td>${(ureaAmount * prices.urea).toFixed(0)}</td>
                            </tr>
                            <tr>
                                <td>DAP</td>
                                <td>18-46-0</td>
                                <td class="fw-bold text-primary">${dapAmount.toFixed(2)}</td>
                                <td>${(dapAmount * prices.dap).toFixed(0)}</td>
                            </tr>
                            <tr>
                                <td>MOP</td>
                                <td>0-0-60</td>
                                <td class="fw-bold text-primary">${mopAmount.toFixed(2)}</td>
                                <td>${(mopAmount * prices.mop).toFixed(0)}</td>
                            </tr>
                            ${dolomiteAmount > 0 ? `
                            <tr>
                                <td>Dolomite</td>
                                <td>Ca+Mg</td>
                                <td class="fw-bold text-primary">${dolomiteAmount.toFixed(2)}</td>
                                <td>${(dolomiteAmount * prices.dolomite).toFixed(0)}</td>
                            </tr>` : ''}
                            <tr class="table-secondary">
                                <td>Filler (‡∏î‡∏¥‡∏ô/‡∏ó‡∏£‡∏≤‡∏¢)</td>
                                <td>-</td>
                                <td class="fw-bold">${filler > 0 ? filler.toFixed(2) : 0}</td>
                                <td>-</td>
                            </tr>
                            <tr class="table-success">
                                <td colspan="2" class="fw-bold">‡∏£‡∏ß‡∏°‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</td>
                                <td class="fw-bold">${weight.toFixed(2)}</td>
                                <td class="fw-bold">${totalCost.toFixed(0)}</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
                <p class="small text-muted mb-0">* ‡∏™‡∏π‡∏ï‡∏£‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡πÇ‡∏î‡∏¢‡∏õ‡∏£‡∏∞‡∏°‡∏≤‡∏ì ‡∏£‡∏≤‡∏Ñ‡∏≤‡∏≠‡∏≤‡∏à‡πÅ‡∏ï‡∏Å‡∏ï‡πà‡∏≤‡∏á‡∏ï‡∏≤‡∏°‡∏ó‡πâ‡∏≠‡∏á‡∏ï‡∏•‡∏≤‡∏î</p>
            `;
            
            document.getElementById('fertilizerDetails').innerHTML = resultHtml;
            document.getElementById('fertilizerResult').style.display = 'block';
        }

        // Cost-Benefit Analysis
        function calculateCostBenefit() {
            const landCost = parseFloat(document.getElementById('landCost').value) || 0;
            const equipmentCost = parseFloat(document.getElementById('equipmentCost').value) || 0;
            const utilityCost = parseFloat(document.getElementById('utilityCost').value) || 0;
            const seedCost = parseFloat(document.getElementById('seedCost').value) || 0;
            const fertilCost = parseFloat(document.getElementById('fertilCost2').value) || 0;
            const laborCost = parseFloat(document.getElementById('laborCost').value) || 0;
            const cyclePerYear = parseFloat(document.getElementById('cyclePerYear').value) || 1;
            const yieldPerCycle = parseFloat(document.getElementById('expectedYield2').value) || 0;
            const price = parseFloat(document.getElementById('sellingPrice2').value) || 0;

            // Calculate costs
            const annualFixedCost = landCost + (equipmentCost / 5) + (utilityCost * 12); // Equipment depreciation 5 years
            const costPerCycle = seedCost + fertilCost + laborCost;
            const annualVariableCost = costPerCycle * cyclePerYear;
            const totalAnnualCost = annualFixedCost + annualVariableCost;

            // Calculate revenue
            const revenuePerCycle = yieldPerCycle * price;
            const annualRevenue = revenuePerCycle * cyclePerYear;
            const annualProfit = annualRevenue - totalAnnualCost;

            // Calculate ROI
            const roi = ((annualProfit / totalAnnualCost) * 100);
            const breakEvenKg = totalAnnualCost / price;
            const paybackMonths = equipmentCost > 0 ? (equipmentCost / (annualProfit / 12)) : 0;

            let profitClass = annualProfit >= 0 ? 'text-success' : 'text-danger';
            let profitIcon = annualProfit >= 0 ? 'fa-arrow-up' : 'fa-arrow-down';

            const resultHtml = `
                <div class="row text-center mb-3">
                    <div class="col-md-3">
                        <div class="p-3 bg-light rounded">
                            <h6 class="text-muted small">‡∏£‡∏≤‡∏¢‡πÑ‡∏î‡πâ‡∏ï‡πà‡∏≠‡∏õ‡∏µ</h6>
                            <h4 class="text-primary">${annualRevenue.toLocaleString()}</h4>
                            <small class="text-muted">‡∏ö‡∏≤‡∏ó</small>
                        </div>
                    </div>
                    <div class="col-md-3">
                        <div class="p-3 bg-light rounded">
                            <h6 class="text-muted small">‡∏ï‡πâ‡∏ô‡∏ó‡∏∏‡∏ô‡∏ï‡πà‡∏≠‡∏õ‡∏µ</h6>
                            <h4 class="text-warning">${totalAnnualCost.toLocaleString()}</h4>
                            <small class="text-muted">‡∏ö‡∏≤‡∏ó</small>
                        </div>
                    </div>
                    <div class="col-md-3">
                        <div class="p-3 bg-light rounded">
                            <h6 class="text-muted small">‡∏Å‡∏≥‡πÑ‡∏£‡∏™‡∏∏‡∏ó‡∏ò‡∏¥</h6>
                            <h4 class="${profitClass}"><i class="fas ${profitIcon}"></i> ${annualProfit.toLocaleString()}</h4>
                            <small class="text-muted">‡∏ö‡∏≤‡∏ó/‡∏õ‡∏µ</small>
                        </div>
                    </div>
                    <div class="col-md-3">
                        <div class="p-3 bg-light rounded">
                            <h6 class="text-muted small">ROI</h6>
                            <h4 class="${profitClass}">${roi.toFixed(1)}%</h4>
                            <small class="text-muted">‡∏ú‡∏•‡∏ï‡∏≠‡∏ö‡πÅ‡∏ó‡∏ô</small>
                        </div>
                    </div>
                </div>
                <div class="row">
                    <div class="col-md-6">
                        <div class="alert alert-info">
                            <strong><i class="fas fa-balance-scale"></i> ‡∏à‡∏∏‡∏î‡∏Ñ‡∏∏‡πâ‡∏°‡∏ó‡∏∏‡∏ô:</strong><br> 
                            ‡∏ï‡πâ‡∏≠‡∏á‡∏ú‡∏•‡∏¥‡∏ï‡πÉ‡∏´‡πâ‡πÑ‡∏î‡πâ <strong>${breakEvenKg.toLocaleString()} ‡∏Å‡∏Å./‡∏õ‡∏µ</strong>
                        </div>
                    </div>
                    <div class="col-md-6">
                        <div class="alert alert-success">
                            <strong><i class="fas fa-clock"></i> ‡∏£‡∏∞‡∏¢‡∏∞‡πÄ‡∏ß‡∏•‡∏≤‡∏Ñ‡∏∑‡∏ô‡∏ó‡∏∏‡∏ô:</strong><br>
                            <strong>${paybackMonths > 0 ? paybackMonths.toFixed(1) + ' ‡πÄ‡∏î‡∏∑‡∏≠‡∏ô' : 'N/A'}</strong>
                        </div>
                    </div>
                </div>
                <div class="alert alert-warning mb-0">
                    <strong><i class="fas fa-lightbulb"></i> ‡∏Ñ‡∏≥‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥:</strong><br>
                    ${roi > 20 ? '‚úÖ ‡∏ú‡∏•‡∏ï‡∏≠‡∏ö‡πÅ‡∏ó‡∏ô‡∏î‡∏µ‡∏°‡∏≤‡∏Å ‡∏Ñ‡∏∏‡πâ‡∏°‡∏Ñ‡πà‡∏≤‡∏Å‡∏≤‡∏£‡∏•‡∏á‡∏ó‡∏∏‡∏ô' : 
                      roi > 10 ? '‚ö†Ô∏è ‡∏ú‡∏•‡∏ï‡∏≠‡∏ö‡πÅ‡∏ó‡∏ô‡∏õ‡∏≤‡∏ô‡∏Å‡∏•‡∏≤‡∏á ‡∏û‡∏¥‡∏à‡∏≤‡∏£‡∏ì‡∏≤‡∏•‡∏î‡∏ï‡πâ‡∏ô‡∏ó‡∏∏‡∏ô‡∏´‡∏£‡∏∑‡∏≠‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏£‡∏≤‡∏Ñ‡∏≤‡∏Ç‡∏≤‡∏¢' :
                      '‚ùå ‡∏ú‡∏•‡∏ï‡∏≠‡∏ö‡πÅ‡∏ó‡∏ô‡∏ï‡πà‡∏≥ ‡∏Ñ‡∏ß‡∏£‡∏õ‡∏£‡∏±‡∏ö‡πÅ‡∏ú‡∏ô‡∏Å‡∏≤‡∏£‡∏ú‡∏•‡∏¥‡∏ï‡∏´‡∏£‡∏∑‡∏≠‡∏´‡∏≤‡∏û‡∏∑‡∏ä‡∏ó‡∏î‡πÅ‡∏ó‡∏ô'}
                </div>
            `;
            
            document.getElementById('costDetails').innerHTML = resultHtml;
            document.getElementById('costResult').style.display = 'block';
        }

        // Area Conversion
        function convertArea() {
            const rai = parseFloat(document.getElementById('rai').value) || 0;
            const ngan = parseFloat(document.getElementById('ngan').value) || 0;
            const wah = parseFloat(document.getElementById('wah').value) || 0;

            const totalWah = (rai * 400) + (ngan * 100) + wah;
            const totalSqm = totalWah * 4;
            const totalAcre = totalSqm / 4046.86;
            const totalHectare = totalSqm / 10000;

            const resultHtml = `
                <div class="row text-center">
                    <div class="col-6 mb-2">
                        <strong>${totalWah.toLocaleString()}</strong><br>
                        <small class="text-muted">‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡∏ß‡∏≤</small>
                    </div>
                    <div class="col-6 mb-2">
                        <strong>${totalSqm.toLocaleString()}</strong><br>
                        <small class="text-muted">‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡πÄ‡∏°‡∏ï‡∏£</small>
                    </div>
                    <div class="col-6">
                        <strong>${totalAcre.toFixed(2)}</strong><br>
                        <small class="text-muted">‡πÄ‡∏≠‡πÄ‡∏Ñ‡∏≠‡∏£‡πå</small>
                    </div>
                    <div class="col-6">
                        <strong>${totalHectare.toFixed(2)}</strong><br>
                        <small class="text-muted">‡πÄ‡∏Æ‡∏Å‡∏ï‡∏≤‡∏£‡πå</small>
                    </div>
                </div>
            `;
            
            document.getElementById('areaDetails').innerHTML = resultHtml;
            document.getElementById('areaResult').style.display = 'block';
        }

        function calculatePlants() {
            const plantSpace = parseFloat(document.getElementById('plantSpace').value) || 0;
            const rowSpace = parseFloat(document.getElementById('rowSpace').value) || 0;
            const areaRai = parseFloat(document.getElementById('plantArea').value) || 0;

            if (plantSpace === 0 || rowSpace === 0 || areaRai === 0) {
                alert('‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏´‡πâ‡∏Ñ‡∏£‡∏ö‡∏ñ‡πâ‡∏ß‡∏ô');
                return;
            }

            const areaSqm = areaRai * 1600;
            const areaPerPlant = plantSpace * rowSpace;
            const totalPlants = Math.floor(areaSqm / areaPerPlant);
            const density = Math.floor(1600 / areaPerPlant);

            document.getElementById('plantCount').innerText = `${totalPlants.toLocaleString()} ‡∏ï‡πâ‡∏ô`;
            document.getElementById('plantDensity').innerText = density.toLocaleString();
            document.getElementById('plantResult').style.display = 'block';
        }

        // Water Calculation
        function calculateWater() {
            const kc = parseFloat(document.getElementById('cropType').value);
            const areaRai = parseFloat(document.getElementById('waterArea').value) || 0;
            const et0 = parseFloat(document.getElementById('evaporation').value) || 0;
            const efficiency = parseFloat(document.getElementById('irrigationEfficiency').value);

            if (areaRai === 0) {
                alert('‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏£‡∏∞‡∏ö‡∏∏‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà‡∏õ‡∏•‡∏π‡∏Å');
                return;
            }

            const areaSqm = areaRai * 1600;
            const etc = kc * et0; // mm/day
            const waterLitersDaily = (etc * areaSqm) / efficiency;
            const waterCubicMonthly = (waterLitersDaily * 30) / 1000;
            const waterCubicYearly = (waterLitersDaily * 365) / 1000;

            document.getElementById('waterDaily').innerText = `${waterLitersDaily.toLocaleString()} ‡∏•‡∏¥‡∏ï‡∏£`;
            document.getElementById('waterMonthly').innerText = `${waterCubicMonthly.toLocaleString()} ‡∏•‡∏ö.‡∏°.`;
            document.getElementById('waterYearly').innerText = `${waterCubicYearly.toLocaleString()} ‡∏•‡∏ö.‡∏°.`;
            document.getElementById('waterResult').style.display = 'block';
        }

        // Initialize on load
        document.addEventListener('DOMContentLoaded', function() {
            initCropSelector();
            updateCalendar();
            initNABCData();
        });

        // ==================== NABC API Integration ====================
        const NABC_API_BASE = 'https://agriapi.nabc.go.th';

        // Thai provinces list
        const thaiProvinces = [
            '‡∏Å‡∏£‡∏∏‡∏á‡πÄ‡∏ó‡∏û‡∏°‡∏´‡∏≤‡∏ô‡∏Ñ‡∏£', '‡∏Å‡∏£‡∏∞‡∏ö‡∏µ‡πà', '‡∏Å‡∏≤‡∏ç‡∏à‡∏ô‡∏ö‡∏∏‡∏£‡∏µ', '‡∏Å‡∏≤‡∏¨‡∏™‡∏¥‡∏ô‡∏ò‡∏∏‡πå', '‡∏Å‡∏≥‡πÅ‡∏û‡∏á‡πÄ‡∏û‡∏ä‡∏£',
            '‡∏Ç‡∏≠‡∏ô‡πÅ‡∏Å‡πà‡∏ô', '‡∏à‡∏±‡∏ô‡∏ó‡∏ö‡∏∏‡∏£‡∏µ', '‡∏â‡∏∞‡πÄ‡∏ä‡∏¥‡∏á‡πÄ‡∏ó‡∏£‡∏≤', '‡∏ä‡∏•‡∏ö‡∏∏‡∏£‡∏µ', '‡∏ä‡∏±‡∏¢‡∏ô‡∏≤‡∏ó',
            '‡∏ä‡∏±‡∏¢‡∏†‡∏π‡∏°‡∏¥', '‡∏ä‡∏∏‡∏°‡∏û‡∏£', '‡πÄ‡∏ä‡∏µ‡∏¢‡∏á‡∏£‡∏≤‡∏¢', '‡πÄ‡∏ä‡∏µ‡∏¢‡∏á‡πÉ‡∏´‡∏°‡πà', '‡∏ï‡∏£‡∏±‡∏á',
            '‡∏ï‡∏£‡∏≤‡∏î', '‡∏ï‡∏≤‡∏Å', '‡∏ô‡∏Ñ‡∏£‡∏ô‡∏≤‡∏¢‡∏Å', '‡∏ô‡∏Ñ‡∏£‡∏õ‡∏ê‡∏°', '‡∏ô‡∏Ñ‡∏£‡∏û‡∏ô‡∏°',
            '‡∏ô‡∏Ñ‡∏£‡∏£‡∏≤‡∏ä‡∏™‡∏µ‡∏°‡∏≤', '‡∏ô‡∏Ñ‡∏£‡∏®‡∏£‡∏µ‡∏ò‡∏£‡∏£‡∏°‡∏£‡∏≤‡∏ä', '‡∏ô‡∏Ñ‡∏£‡∏™‡∏ß‡∏£‡∏£‡∏Ñ‡πå', '‡∏ô‡∏ô‡∏ó‡∏ö‡∏∏‡∏£‡∏µ', '‡∏ô‡∏£‡∏≤‡∏ò‡∏¥‡∏ß‡∏≤‡∏™',
            '‡∏ô‡πà‡∏≤‡∏ô', '‡∏ö‡∏∂‡∏á‡∏Å‡∏≤‡∏¨', '‡∏ö‡∏∏‡∏£‡∏µ‡∏£‡∏±‡∏°‡∏¢‡πå', '‡∏õ‡∏ó‡∏∏‡∏°‡∏ò‡∏≤‡∏ô‡∏µ', '‡∏õ‡∏£‡∏∞‡∏à‡∏ß‡∏ö‡∏Ñ‡∏µ‡∏£‡∏µ‡∏Ç‡∏±‡∏ô‡∏ò‡πå',
            '‡∏õ‡∏£‡∏≤‡∏à‡∏µ‡∏ô‡∏ö‡∏∏‡∏£‡∏µ', '‡∏õ‡∏±‡∏ï‡∏ï‡∏≤‡∏ô‡∏µ', '‡∏û‡∏£‡∏∞‡∏ô‡∏Ñ‡∏£‡∏®‡∏£‡∏µ‡∏≠‡∏¢‡∏∏‡∏ò‡∏¢‡∏≤', '‡∏û‡∏±‡∏á‡∏á‡∏≤', '‡∏û‡∏±‡∏ó‡∏•‡∏∏‡∏á',
            '‡∏û‡∏¥‡∏à‡∏¥‡∏ï‡∏£', '‡∏û‡∏¥‡∏©‡∏ì‡∏∏‡πÇ‡∏•‡∏Å', '‡πÄ‡∏û‡∏ä‡∏£‡∏ö‡∏∏‡∏£‡∏µ', '‡πÄ‡∏û‡∏ä‡∏£‡∏ö‡∏π‡∏£‡∏ì‡πå', '‡πÅ‡∏û‡∏£‡πà',
            '‡∏†‡∏π‡πÄ‡∏Å‡πá‡∏ï', '‡∏°‡∏´‡∏≤‡∏™‡∏≤‡∏£‡∏Ñ‡∏≤‡∏°', '‡∏°‡∏∏‡∏Å‡∏î‡∏≤‡∏´‡∏≤‡∏£', '‡πÅ‡∏°‡πà‡∏Æ‡πà‡∏≠‡∏á‡∏™‡∏≠‡∏ô', '‡∏¢‡πÇ‡∏™‡∏ò‡∏£',
            '‡∏¢‡∏∞‡∏•‡∏≤', '‡∏£‡πâ‡∏≠‡∏¢‡πÄ‡∏≠‡πá‡∏î', '‡∏£‡∏∞‡∏ô‡∏≠‡∏á', '‡∏£‡∏∞‡∏¢‡∏≠‡∏á', '‡∏£‡∏≤‡∏ä‡∏ö‡∏∏‡∏£‡∏µ',
            '‡∏•‡∏û‡∏ö‡∏∏‡∏£‡∏µ', '‡∏•‡∏≥‡∏õ‡∏≤‡∏á', '‡∏•‡∏≥‡∏û‡∏π‡∏ô', '‡πÄ‡∏•‡∏¢', '‡∏®‡∏£‡∏µ‡∏™‡∏∞‡πÄ‡∏Å‡∏©',
            '‡∏™‡∏Å‡∏•‡∏ô‡∏Ñ‡∏£', '‡∏™‡∏á‡∏Ç‡∏•‡∏≤', '‡∏™‡∏ï‡∏π‡∏•', '‡∏™‡∏°‡∏∏‡∏ó‡∏£‡∏õ‡∏£‡∏≤‡∏Å‡∏≤‡∏£', '‡∏™‡∏°‡∏∏‡∏ó‡∏£‡∏™‡∏á‡∏Ñ‡∏£‡∏≤‡∏°',
            '‡∏™‡∏°‡∏∏‡∏ó‡∏£‡∏™‡∏≤‡∏Ñ‡∏£', '‡∏™‡∏£‡∏∞‡πÅ‡∏Å‡πâ‡∏ß', '‡∏™‡∏£‡∏∞‡∏ö‡∏∏‡∏£‡∏µ', '‡∏™‡∏¥‡∏á‡∏´‡πå‡∏ö‡∏∏‡∏£‡∏µ', '‡∏™‡∏∏‡πÇ‡∏Ç‡∏ó‡∏±‡∏¢',
            '‡∏™‡∏∏‡∏û‡∏£‡∏£‡∏ì‡∏ö‡∏∏‡∏£‡∏µ', '‡∏™‡∏∏‡∏£‡∏≤‡∏©‡∏é‡∏£‡πå‡∏ò‡∏≤‡∏ô‡∏µ', '‡∏™‡∏∏‡∏£‡∏¥‡∏ô‡∏ó‡∏£‡πå', '‡∏´‡∏ô‡∏≠‡∏á‡∏Ñ‡∏≤‡∏¢', '‡∏´‡∏ô‡∏≠‡∏á‡∏ö‡∏±‡∏ß‡∏•‡∏≥‡∏†‡∏π',
            '‡∏≠‡πà‡∏≤‡∏á‡∏ó‡∏≠‡∏á', '‡∏≠‡∏≥‡∏ô‡∏≤‡∏à‡πÄ‡∏à‡∏£‡∏¥‡∏ç', '‡∏≠‡∏∏‡∏î‡∏£‡∏ò‡∏≤‡∏ô‡∏µ', '‡∏≠‡∏∏‡∏ï‡∏£‡∏î‡∏¥‡∏ï‡∏ñ‡πå', '‡∏≠‡∏∏‡∏ó‡∏±‡∏¢‡∏ò‡∏≤‡∏ô‡∏µ',
            '‡∏≠‡∏∏‡∏ö‡∏•‡∏£‡∏≤‡∏ä‡∏ò‡∏≤‡∏ô‡∏µ'
        ];

        // Crop categories for NABC
        const nabcCropCategories = [
            { id: 'rice', name: '‡∏Ç‡πâ‡∏≤‡∏ß', icon: 'fa-wheat-awn' },
            { id: 'sugarcane', name: '‡∏≠‡πâ‡∏≠‡∏¢', icon: 'fa-candy-cane' },
            { id: 'cassava', name: '‡∏°‡∏±‡∏ô‡∏™‡∏≥‡∏õ‡∏∞‡∏´‡∏•‡∏±‡∏á', icon: 'fa-carrot' },
            { id: 'corn', name: '‡∏Ç‡πâ‡∏≤‡∏ß‡πÇ‡∏û‡∏î', icon: 'fa-seedling' },
            { id: 'rubber', name: '‡∏¢‡∏≤‡∏á‡∏û‡∏≤‡∏£‡∏≤', icon: 'fa-tree' },
            { id: 'palm', name: '‡∏õ‡∏≤‡∏•‡πå‡∏°‡∏ô‡πâ‡∏≥‡∏°‡∏±‡∏ô', icon: 'fa-leaf' },
            { id: 'fruit', name: '‡πÑ‡∏°‡πâ‡∏ú‡∏•', icon: 'fa-apple-whole' },
            { id: 'vegetable', name: '‡∏û‡∏∑‡∏ä‡∏ú‡∏±‡∏Å', icon: 'fa-carrot' }
        ];

        function initNABCData() {
            // Populate province select
            const provinceSelect = document.getElementById('nabcProvince');
            if (provinceSelect) {
                thaiProvinces.forEach(province => {
                    const option = document.createElement('option');
                    option.value = province;
                    option.textContent = province;
                    provinceSelect.appendChild(option);
                });
            }

            // Render crop category cards
            renderNABCCropCards();

            // Load initial data (simulated)
            loadNABCProductionData();
        }

        function renderNABCCropCards() {
            const container = document.getElementById('nabcCropCards');
            if (!container) return;

            container.innerHTML = nabcCropCategories.map(crop => `
                <div class="col-md-3 col-6">
                    <div class="stat-box" onclick="selectNABCCrop('${crop.id}')" id="nabc-crop-${crop.id}">
                        <i class="fas ${crop.icon} fa-2x mb-2 text-success"></i>
                        <div class="label">${crop.name}</div>
                    </div>
                </div>
            `).join('');
        }

        function selectNABCCrop(cropId) {
            // Update selection UI
            document.querySelectorAll('#nabcCropCards .stat-box').forEach(box => {
                box.classList.remove('selected');
                box.style.borderColor = 'transparent';
            });
            const selected = document.getElementById(`nabc-crop-${cropId}`);
            if (selected) {
                selected.style.borderColor = 'var(--primary-color)';
                selected.style.border = '2px solid var(--primary-color)';
            }

            // Load data for selected crop
            loadNABCCropData(cropId);
        }

        async function loadNABCProductionData() {
            showNABCLoading(true);

            try {
                // Note: This is a demo implementation
                // In production, you would call the actual NABC API
                // const response = await fetch(`${NABC_API_BASE}/api/production/summary`);
                // const data = await response.json();

                // Simulated data for demonstration
                const demoData = generateDemoProductionData();
                displayNABCProductionSummary(demoData);
            } catch (error) {
                console.error('Error loading NABC data:', error);
                displayNABCError('‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÑ‡∏î‡πâ ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏•‡∏≠‡∏á‡πÉ‡∏´‡∏°‡πà‡∏≠‡∏µ‡∏Å‡∏Ñ‡∏£‡∏±‡πâ‡∏á');
            } finally {
                showNABCLoading(false);
            }
        }

        async function loadNABCCropData(cropId) {
            showNABCLoading(true);

            try {
                const province = document.getElementById('nabcProvince')?.value || '';
                const year = document.getElementById('nabcYear')?.value || new Date().getFullYear();

                // In production: call actual API
                // const url = `${NABC_API_BASE}/api/production/${cropId}?province=${province}&year=${year}`;
                // const response = await fetch(url);
                // const data = await response.json();

                const demoData = generateDemoCropData(cropId, province, year);
                displayNABCCropDetails(demoData);
            } catch (error) {
                console.error('Error loading crop data:', error);
                displayNABCError('‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏û‡∏∑‡∏ä‡πÑ‡∏î‡πâ');
            } finally {
                showNABCLoading(false);
            }
        }

        async function fetchNABCPriceData() {
            showNABCLoading(true);

            try {
                const crop = document.getElementById('nabcPriceCrop')?.value || 'rice';

                // Demo price data
                const priceData = generateDemoPriceData(crop);
                displayNABCPrices(priceData);
            } catch (error) {
                console.error('Error loading price data:', error);
                displayNABCError('‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏£‡∏≤‡∏Ñ‡∏≤‡πÑ‡∏î‡πâ');
            } finally {
                showNABCLoading(false);
            }
        }

        function generateDemoProductionData() {
            return {
                totalArea: 149234567,
                totalProduction: 89234123,
                avgYield: 598,
                topCrops: [
                    { name: '‡∏Ç‡πâ‡∏≤‡∏ß', area: 59234567, production: 31234123, change: 2.5 },
                    { name: '‡∏≠‡πâ‡∏≠‡∏¢', area: 12234567, production: 102345678, change: -1.2 },
                    { name: '‡∏°‡∏±‡∏ô‡∏™‡∏≥‡∏õ‡∏∞‡∏´‡∏•‡∏±‡∏á', area: 9234567, production: 31234567, change: 3.8 },
                    { name: '‡∏Ç‡πâ‡∏≤‡∏ß‡πÇ‡∏û‡∏î', area: 7234567, production: 5234567, change: 1.5 },
                    { name: '‡∏¢‡∏≤‡∏á‡∏û‡∏≤‡∏£‡∏≤', area: 23234567, production: 4567890, change: -0.5 }
                ],
                lastUpdated: new Date().toLocaleDateString('th-TH')
            };
        }

        function generateDemoCropData(cropId, province, year) {
            const cropNames = {
                rice: '‡∏Ç‡πâ‡∏≤‡∏ß', sugarcane: '‡∏≠‡πâ‡∏≠‡∏¢', cassava: '‡∏°‡∏±‡∏ô‡∏™‡∏≥‡∏õ‡∏∞‡∏´‡∏•‡∏±‡∏á',
                corn: '‡∏Ç‡πâ‡∏≤‡∏ß‡πÇ‡∏û‡∏î', rubber: '‡∏¢‡∏≤‡∏á‡∏û‡∏≤‡∏£‡∏≤', palm: '‡∏õ‡∏≤‡∏•‡πå‡∏°‡∏ô‡πâ‡∏≥‡∏°‡∏±‡∏ô',
                fruit: '‡πÑ‡∏°‡πâ‡∏ú‡∏•', vegetable: '‡∏û‡∏∑‡∏ä‡∏ú‡∏±‡∏Å'
            };

            return {
                crop: cropNames[cropId] || cropId,
                province: province || '‡∏ó‡∏±‡πâ‡∏á‡∏õ‡∏£‡∏∞‡πÄ‡∏ó‡∏®',
                year: year,
                plantedArea: Math.floor(Math.random() * 10000000) + 1000000,
                harvestedArea: Math.floor(Math.random() * 9000000) + 900000,
                production: Math.floor(Math.random() * 50000000) + 5000000,
                yield: Math.floor(Math.random() * 500) + 300,
                pricePerTon: Math.floor(Math.random() * 5000) + 3000,
                topProvinces: [
                    { name: '‡∏ô‡∏Ñ‡∏£‡∏£‡∏≤‡∏ä‡∏™‡∏µ‡∏°‡∏≤', area: 1234567, production: 2345678 },
                    { name: '‡∏Ç‡∏≠‡∏ô‡πÅ‡∏Å‡πà‡∏ô', area: 1123456, production: 2123456 },
                    { name: '‡∏≠‡∏∏‡∏ö‡∏•‡∏£‡∏≤‡∏ä‡∏ò‡∏≤‡∏ô‡∏µ', area: 1012345, production: 1912345 },
                    { name: '‡∏™‡∏∏‡∏£‡∏¥‡∏ô‡∏ó‡∏£‡πå', area: 901234, production: 1701234 },
                    { name: '‡∏ö‡∏∏‡∏£‡∏µ‡∏£‡∏±‡∏°‡∏¢‡πå', area: 801234, production: 1501234 }
                ]
            };
        }

        function generateDemoPriceData(crop) {
            const basePrice = {
                rice: 12500, sugarcane: 1100, cassava: 2800,
                corn: 9500, rubber: 45000, palm: 5500
            }[crop] || 5000;

            const months = ['‡∏°.‡∏Ñ.', '‡∏Å.‡∏û.', '‡∏°‡∏µ.‡∏Ñ.', '‡πÄ‡∏°.‡∏¢.', '‡∏û.‡∏Ñ.', '‡∏°‡∏¥.‡∏¢.',
                           '‡∏Å.‡∏Ñ.', '‡∏™.‡∏Ñ.', '‡∏Å.‡∏¢.', '‡∏ï.‡∏Ñ.', '‡∏û.‡∏¢.', '‡∏ò.‡∏Ñ.'];

            return months.map((month, i) => ({
                month: month,
                price: basePrice + Math.floor(Math.random() * 2000) - 1000,
                change: (Math.random() * 10 - 5).toFixed(2)
            }));
        }

        function displayNABCProductionSummary(data) {
            const container = document.getElementById('nabcSummary');
            if (!container) return;

            container.innerHTML = `
                <div class="row g-3 mb-4">
                    <div class="col-md-3 col-6">
                        <div class="stat-box">
                            <div class="value">${(data.totalArea / 1000000).toFixed(1)}M</div>
                            <div class="label">‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà‡πÄ‡∏û‡∏≤‡∏∞‡∏õ‡∏•‡∏π‡∏Å (‡πÑ‡∏£‡πà)</div>
                        </div>
                    </div>
                    <div class="col-md-3 col-6">
                        <div class="stat-box">
                            <div class="value">${(data.totalProduction / 1000000).toFixed(1)}M</div>
                            <div class="label">‡∏ú‡∏•‡∏ú‡∏•‡∏¥‡∏ï‡∏£‡∏ß‡∏° (‡∏ï‡∏±‡∏ô)</div>
                        </div>
                    </div>
                    <div class="col-md-3 col-6">
                        <div class="stat-box">
                            <div class="value">${data.avgYield}</div>
                            <div class="label">‡∏ú‡∏•‡∏ú‡∏•‡∏¥‡∏ï‡πÄ‡∏â‡∏•‡∏µ‡πà‡∏¢ (‡∏Å‡∏Å./‡πÑ‡∏£‡πà)</div>
                        </div>
                    </div>
                    <div class="col-md-3 col-6">
                        <div class="stat-box">
                            <div class="value">77</div>
                            <div class="label">‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏±‡∏î</div>
                        </div>
                    </div>
                </div>

                <div class="card">
                    <div class="card-header">
                        <i class="fas fa-chart-bar"></i> ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏û‡∏∑‡∏ä‡πÄ‡∏®‡∏£‡∏©‡∏ê‡∏Å‡∏¥‡∏à‡∏´‡∏•‡∏±‡∏Å
                    </div>
                    <div class="card-body">
                        <div class="table-responsive">
                            <table class="table data-table">
                                <thead>
                                    <tr>
                                        <th>‡∏û‡∏∑‡∏ä</th>
                                        <th class="text-end">‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà (‡πÑ‡∏£‡πà)</th>
                                        <th class="text-end">‡∏ú‡∏•‡∏ú‡∏•‡∏¥‡∏ï (‡∏ï‡∏±‡∏ô)</th>
                                        <th class="text-end">‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡πÅ‡∏õ‡∏•‡∏á</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    ${data.topCrops.map(crop => `
                                        <tr>
                                            <td><i class="fas fa-seedling text-success me-2"></i>${crop.name}</td>
                                            <td class="text-end">${crop.area.toLocaleString()}</td>
                                            <td class="text-end">${crop.production.toLocaleString()}</td>
                                            <td class="text-end ${crop.change >= 0 ? 'price-up' : 'price-down'}">
                                                <i class="fas fa-arrow-${crop.change >= 0 ? 'up' : 'down'}"></i>
                                                ${Math.abs(crop.change)}%
                                            </td>
                                        </tr>
                                    `).join('')}
                                </tbody>
                            </table>
                        </div>
                        <small class="text-muted">‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î: ${data.lastUpdated}</small>
                    </div>
                </div>
            `;
        }

        function displayNABCCropDetails(data) {
            const container = document.getElementById('nabcCropDetails');
            if (!container) return;

            container.style.display = 'block';
            container.innerHTML = `
                <div class="card mt-4">
                    <div class="card-header">
                        <i class="fas fa-info-circle"></i> ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•${data.crop} - ${data.province} (‡∏õ‡∏µ ${data.year})
                    </div>
                    <div class="card-body">
                        <div class="row g-3 mb-4">
                            <div class="col-md-3 col-6">
                                <div class="stat-box">
                                    <div class="value">${(data.plantedArea / 1000000).toFixed(2)}M</div>
                                    <div class="label">‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà‡∏õ‡∏•‡∏π‡∏Å (‡πÑ‡∏£‡πà)</div>
                                </div>
                            </div>
                            <div class="col-md-3 col-6">
                                <div class="stat-box">
                                    <div class="value">${(data.production / 1000000).toFixed(2)}M</div>
                                    <div class="label">‡∏ú‡∏•‡∏ú‡∏•‡∏¥‡∏ï (‡∏ï‡∏±‡∏ô)</div>
                                </div>
                            </div>
                            <div class="col-md-3 col-6">
                                <div class="stat-box">
                                    <div class="value">${data.yield}</div>
                                    <div class="label">‡∏ú‡∏•‡∏ú‡∏•‡∏¥‡∏ï (‡∏Å‡∏Å./‡πÑ‡∏£‡πà)</div>
                                </div>
                            </div>
                            <div class="col-md-3 col-6">
                                <div class="stat-box">
                                    <div class="value">‡∏ø${data.pricePerTon.toLocaleString()}</div>
                                    <div class="label">‡∏£‡∏≤‡∏Ñ‡∏≤ (‡∏ö‡∏≤‡∏ó/‡∏ï‡∏±‡∏ô)</div>
                                </div>
                            </div>
                        </div>

                        <h6><i class="fas fa-map-marker-alt text-danger"></i> ‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏±‡∏î‡∏ó‡∏µ‡πà‡∏õ‡∏•‡∏π‡∏Å‡∏°‡∏≤‡∏Å‡∏ó‡∏µ‡πà‡∏™‡∏∏‡∏î</h6>
                        <div class="table-responsive">
                            <table class="table data-table table-sm">
                                <thead>
                                    <tr>
                                        <th>#</th>
                                        <th>‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏±‡∏î</th>
                                        <th class="text-end">‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà (‡πÑ‡∏£‡πà)</th>
                                        <th class="text-end">‡∏ú‡∏•‡∏ú‡∏•‡∏¥‡∏ï (‡∏ï‡∏±‡∏ô)</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    ${data.topProvinces.map((prov, i) => `
                                        <tr>
                                            <td>${i + 1}</td>
                                            <td>${prov.name}</td>
                                            <td class="text-end">${prov.area.toLocaleString()}</td>
                                            <td class="text-end">${prov.production.toLocaleString()}</td>
                                        </tr>
                                    `).join('')}
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            `;
        }

        function displayNABCPrices(priceData) {
            const container = document.getElementById('nabcPriceChart');
            if (!container) return;

            container.innerHTML = `
                <div class="table-responsive">
                    <table class="table data-table">
                        <thead>
                            <tr>
                                <th>‡πÄ‡∏î‡∏∑‡∏≠‡∏ô</th>
                                <th class="text-end">‡∏£‡∏≤‡∏Ñ‡∏≤ (‡∏ö‡∏≤‡∏ó/‡∏ï‡∏±‡∏ô)</th>
                                <th class="text-end">‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡πÅ‡∏õ‡∏•‡∏á (%)</th>
                            </tr>
                        </thead>
                        <tbody>
                            ${priceData.map(row => `
                                <tr>
                                    <td>${row.month}</td>
                                    <td class="text-end fw-bold">${row.price.toLocaleString()}</td>
                                    <td class="text-end ${parseFloat(row.change) >= 0 ? 'price-up' : 'price-down'}">
                                        <i class="fas fa-arrow-${parseFloat(row.change) >= 0 ? 'up' : 'down'}"></i>
                                        ${Math.abs(row.change)}%
                                    </td>
                                </tr>
                            `).join('')}
                        </tbody>
                    </table>
                </div>
            `;
        }

        function displayNABCError(message) {
            const container = document.getElementById('nabcSummary');
            if (container) {
                container.innerHTML = `
                    <div class="alert alert-warning">
                        <i class="fas fa-exclamation-triangle"></i> ${message}
                    </div>
                `;
            }
        }

        function showNABCLoading(show) {
            const loader = document.getElementById('nabcLoading');
            if (loader) {
                loader.classList.toggle('active', show);
            }
        }

        function refreshNABCData() {
            loadNABCProductionData();
        }
    </script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>