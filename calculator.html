<!DOCTYPE html>
<html lang="th">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="เครื่องคิดเลขวิศวกรฉีดพลาสติก AI - คำนวณ 10+ เครื่องมือ, วินิจฉัยปัญหา, Vision AI, Digital Logbook - ฟรี 15 ครั้ง! พัฒนาโดย WiT AI">
    <title>🧮 WiT AI Calculator - เครื่องคิดเลขฉีดพลาสติก AI 10+ เครื่องมือ</title>

    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Kanit:wght@300;400;500;600;700&display=swap" rel="stylesheet">

    <style>
        :root {
            --line-green: #00B900;
            --primary-color: #667eea;
            --secondary-color: #40C4FF;
            --success-color: #4CAF50;
            --warning-color: #FFD740;
            --danger-color: #f5576c;
            --dark-color: #2D3436;
            --light-color: #F5F7FA;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Kanit', sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            color: var(--dark-color);
        }

        .app-header {
            background: rgba(255, 255, 255, 0.95);
            padding: 15px 20px;
            box-shadow: 0 2px 20px rgba(0, 0, 0, 0.1);
            position: sticky;
            top: 0;
            z-index: 100;
        }

        .app-home-link {
            color: var(--dark-color);
            text-decoration: none;
            font-weight: 700;
            display: inline-flex;
            align-items: center;
            gap: 8px;
        }

        .app-home-link:hover {
            color: var(--primary-color);
        }

        .app-menu {
            margin-top: 8px;
            display: flex;
            flex-wrap: wrap;
            gap: 10px 14px;
        }

        .app-menu a {
            color: var(--dark-color);
            text-decoration: none;
            font-weight: 600;
            font-size: 0.9rem;
            opacity: 0.9;
        }

        .app-menu a:hover {
            color: var(--primary-color);
            opacity: 1;
        }

        .app-title {
            font-weight: 700;
            font-size: 1.3rem;
            background: linear-gradient(135deg, var(--primary-color), #764ba2);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .sub-title {
            font-size: 0.9rem;
        }

        .trial-badge {
            background: linear-gradient(135deg, var(--warning-color), #FFA000);
            color: var(--dark-color);
            padding: 8px 15px;
            border-radius: 25px;
            font-weight: 600;
            font-size: 0.85rem;
            display: inline-flex;
            align-items: center;
            gap: 8px;
            box-shadow: 0 4px 15px rgba(255, 215, 64, 0.4);
        }

        .trial-badge.premium {
            background: linear-gradient(135deg, var(--line-green), #06C755);
            color: #fff;
        }

        .trial-badge.exhausted {
            background: linear-gradient(135deg, var(--danger-color), #ff4757);
            color: #fff;
        }

        .main-container {
            padding: 20px 15px 110px;
            max-width: 900px;
            margin: 0 auto;
        }

        .calc-tabs {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 10px;
            margin-bottom: 15px;
        }

        @media (min-width: 768px) {
            .calc-tabs {
                grid-template-columns: repeat(5, 1fr);
            }
        }

        .calc-tab {
            border: none;
            border-radius: 14px;
            padding: 10px 8px;
            background: rgba(255, 255, 255, 0.92);
            color: #444;
            font-weight: 600;
            font-size: 0.85rem;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 6px;
            box-shadow: 0 6px 16px rgba(0, 0, 0, 0.12);
        }

        .calc-tab.active {
            outline: 3px solid rgba(102, 126, 234, 0.35);
            color: var(--dark-color);
        }

        .calc-tab i {
            font-size: 1.2rem;
            color: var(--primary-color);
        }

        .calculator-panel {
            display: none;
            background: rgba(255, 255, 255, 0.95);
            border-radius: 18px;
            padding: 18px;
            box-shadow: 0 14px 30px rgba(0, 0, 0, 0.12);
        }

        .calculator-panel.active {
            display: block;
        }

        .calc-title {
            font-weight: 700;
            font-size: 1.15rem;
            margin-bottom: 14px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .calc-title i {
            color: var(--primary-color);
        }

        .btn-calculate {
            width: 100%;
            border-radius: 14px;
            padding: 12px 14px;
            background: linear-gradient(135deg, var(--primary-color), #764ba2);
            border: none;
            color: #fff;
            font-weight: 700;
        }

        .result-section {
            margin-top: 14px;
            padding: 14px;
            border-radius: 14px;
            background: rgba(102, 126, 234, 0.08);
            display: none;
        }

        .result-section.show {
            display: block;
        }

        .result-title {
            font-weight: 700;
            margin: 0 0 8px;
        }

        .result-value {
            font-weight: 800;
            font-size: 2rem;
            line-height: 1;
            color: var(--primary-color);
        }

        .result-unit {
            font-weight: 700;
            opacity: 0.75;
        }

        .result-details {
            margin-top: 10px;
        }

        .result-row {
            display: flex;
            justify-content: space-between;
            gap: 10px;
            padding: 6px 0;
            border-bottom: 1px dashed rgba(0, 0, 0, 0.12);
        }

        .result-row:last-child {
            border-bottom: none;
        }

        .recommendation {
            margin-top: 10px;
            display: flex;
            gap: 8px;
            align-items: center;
            font-weight: 600;
        }

        .recommendation i {
            color: var(--success-color);
        }

        .material-pills {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
        }

        .material-pill {
            border: 1px solid rgba(0, 0, 0, 0.12);
            background: #fff;
            border-radius: 999px;
            padding: 6px 10px;
            font-weight: 600;
            font-size: 0.85rem;
        }

        .material-pill.active {
            border-color: rgba(102, 126, 234, 0.4);
            background: rgba(102, 126, 234, 0.08);
        }

        .range-readout {
            font-weight: 700;
            color: var(--primary-color);
        }

        .kaizen-card {
            margin-top: 16px;
            border-radius: 18px;
            padding: 16px;
            background: rgba(255, 255, 255, 0.95);
            box-shadow: 0 14px 30px rgba(0, 0, 0, 0.12);
        }

        .kaizen-card h5 {
            font-weight: 800;
            margin-bottom: 6px;
        }

        .kaizen-features {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
        }

        .kaizen-tag {
            background: rgba(64, 196, 255, 0.12);
            border: 1px solid rgba(64, 196, 255, 0.28);
            color: #1b3a4a;
            padding: 6px 10px;
            border-radius: 999px;
            font-weight: 600;
            font-size: 0.85rem;
        }

        .btn-kaizen {
            border-radius: 12px;
            font-weight: 700;
        }

        .line-modal-overlay {
            display: none;
            position: fixed;
            inset: 0;
            background: rgba(0, 0, 0, 0.55);
            z-index: 999;
            align-items: center;
            justify-content: center;
            padding: 18px;
        }

        .line-modal {
            width: 100%;
            max-width: 520px;
            background: #fff;
            border-radius: 18px;
            padding: 18px;
            box-shadow: 0 20px 50px rgba(0, 0, 0, 0.25);
        }

        .line-modal-icon {
            width: 56px;
            height: 56px;
            border-radius: 16px;
            background: linear-gradient(135deg, var(--line-green), #06C755);
            display: grid;
            place-items: center;
            color: #fff;
            font-size: 26px;
            margin-bottom: 12px;
        }

        .btn-line-login {
            display: flex;
            gap: 10px;
            align-items: center;
            justify-content: center;
            width: 100%;
            border-radius: 14px;
            padding: 12px 14px;
            background: linear-gradient(135deg, var(--line-green), #06C755);
            border: none;
            color: #fff;
            font-weight: 800;
            text-decoration: none;
            margin-top: 12px;
        }

        .modal-benefits {
            margin-top: 12px;
            padding: 12px;
            border-radius: 14px;
            background: rgba(0, 185, 0, 0.08);
        }

        .benefit-item {
            display: flex;
            gap: 10px;
            align-items: center;
            padding: 6px 0;
            font-weight: 600;
        }

        .benefit-item i {
            color: var(--line-green);
        }

        .modal-smallprint {
            margin-top: 10px;
            opacity: 0.75;
            font-size: 0.9rem;
        }

        .app-footer {
            position: fixed;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(255, 255, 255, 0.95);
            padding: 10px 14px;
            text-align: center;
            box-shadow: 0 -2px 20px rgba(0, 0, 0, 0.08);
        }

        .app-footer p {
            margin: 0;
            font-size: 0.9rem;
        }

        .footer-link {
            color: var(--primary-color);
            font-weight: 700;
            text-decoration: none;
        }
    </style>
</head>

<body>
    <header class="app-header">
        <div class="d-flex align-items-start justify-content-between gap-3">
            <div>
                <a class="app-home-link" href="/">
                    <i class="fas fa-arrow-left"></i>
                    <span class="app-title">🧮 WiT AI Calculator</span>
                </a>
                <div class="text-muted sub-title">Injection Molding AI • 10+ Calculators</div>
                <div class="app-menu">
                    <a href="/#problems">ปัญหา</a>
                    <a href="/#solutions">โซลูชัน</a>
                    <a href="/#how">วิธีใช้</a>
                    <a href="/#pricing">แพ็คเกจ</a>
                    <a href="/marketplace.html">ตลาด</a>
                </div>
            </div>
            <div class="d-flex align-items-center gap-2">
                <button type="button" class="btn btn-sm btn-success" onclick="showLineModal()">
                    <i class="fab fa-line me-1"></i>ปลดล็อก
                </button>
                <div id="trialBadge" class="trial-badge">
                    <i class="fas fa-gift"></i>
                    <span id="trialText">ฟรี 15/15</span>
                </div>
            </div>
        </div>
    </header>

    <main class="main-container">
        <div class="calc-tabs">
            <button type="button" class="calc-tab active" data-calc="clamp">
                <i class="fas fa-lock"></i>
                <span>แรงปิด</span>
            </button>
            <button type="button" class="calc-tab" data-calc="cool">
                <i class="fas fa-snowflake"></i>
                <span>Cooling</span>
            </button>
            <button type="button" class="calc-tab" data-calc="shot">
                <i class="fas fa-fill-drip"></i>
                <span>Shot</span>
            </button>
            <button type="button" class="calc-tab" data-calc="cycle">
                <i class="fas fa-clock"></i>
                <span>Cycle</span>
            </button>
            <button type="button" class="calc-tab" data-calc="gate">
                <i class="fas fa-door-open"></i>
                <span>Gate</span>
            </button>
            <button type="button" class="calc-tab" data-calc="shrink">
                <i class="fas fa-compress"></i>
                <span>Shrink</span>
            </button>
            <button type="button" class="calc-tab" data-calc="temp">
                <i class="fas fa-temperature-high"></i>
                <span>Temp</span>
            </button>
            <button type="button" class="calc-tab" data-calc="vp">
                <i class="fas fa-ruler-combined"></i>
                <span>V-P</span>
            </button>
            <button type="button" class="calc-tab" data-calc="machine">
                <i class="fas fa-industry"></i>
                <span>เครื่อง</span>
            </button>
            <button type="button" class="calc-tab" data-calc="vision">
                <i class="fas fa-eye"></i>
                <span>Vision</span>
            </button>
        </div>

        <section class="calculator-panel active" id="calc-clamp">
            <div class="calc-title"><i class="fas fa-lock"></i>คำนวณแรงปิด (Clamping Force)</div>

            <div class="mb-3">
                <label class="form-label"><i class="fas fa-vector-square me-1"></i>พื้นที่ฉาย (Projected Area)</label>
                <div class="input-group">
                    <input type="number" class="form-control" id="clamp-area" placeholder="เช่น 350" title="พื้นที่ฉาย" inputmode="decimal">
                    <span class="input-group-text">cm²</span>
                </div>
            </div>

            <div class="mb-3">
                <label class="form-label"><i class="fas fa-tachometer-alt me-1"></i>แรงดันฉีดประมาณ</label>
                <div class="input-group">
                    <input type="number" class="form-control" id="clamp-pressure" placeholder="เช่น 40" title="แรงดันฉีด" inputmode="decimal">
                    <span class="input-group-text">kg/cm²</span>
                </div>
                <div class="mt-2 material-pills">
                    <button type="button" class="material-pill" data-pressure="35">PP</button>
                    <button type="button" class="material-pill" data-pressure="40">ABS</button>
                    <button type="button" class="material-pill" data-pressure="45">PC</button>
                    <button type="button" class="material-pill" data-pressure="45">PA</button>
                </div>
            </div>

            <div class="mb-3">
                <label class="form-label"><i class="fas fa-shield-alt me-1"></i>Safety Factor</label>
                <select class="form-select" id="clamp-safety" title="Safety factor">
                    <option value="1.1">1.10 (งานนิ่ง)</option>
                    <option value="1.2" selected>1.20 (ทั่วไป)</option>
                    <option value="1.3">1.30 (งานยาก)</option>
                </select>
            </div>

            <button class="btn btn-calculate" type="button" onclick="calculateClamping()">
                <i class="fas fa-calculator me-2"></i>คำนวณ
            </button>

            <div class="result-section" id="result-clamp">
                <h5 class="result-title"><i class="fas fa-lock me-2"></i>แรงปิดที่ต้องใช้</h5>
                <div class="result-value" id="clamp-result">-</div>
                <div class="result-unit">ton</div>

                <div class="result-details">
                    <div class="result-row"><span>Area</span><span id="clamp-area-out">-</span></div>
                    <div class="result-row"><span>Pressure</span><span id="clamp-pressure-out">-</span></div>
                    <div class="result-row"><span>Safety</span><span id="clamp-safety-out">-</span></div>
                </div>
            </div>
        </section>

        <section class="calculator-panel" id="calc-cool">
            <div class="calc-title"><i class="fas fa-snowflake"></i>คำนวณ Cooling Time</div>

            <div class="mb-3">
                <label class="form-label"><i class="fas fa-layer-group me-1"></i>ความหนาชิ้นงาน</label>
                <div class="input-group">
                    <input type="number" class="form-control" id="cool-thickness" placeholder="เช่น 2.5" title="ความหนาชิ้นงาน" inputmode="decimal">
                    <span class="input-group-text">mm</span>
                </div>
            </div>

            <div class="mb-3">
                <label class="form-label"><i class="fas fa-vial me-1"></i>วัสดุ</label>
                <select class="form-select" id="cool-material" title="วัสดุ">
                    <option value="PP">PP</option>
                    <option value="ABS" selected>ABS</option>
                    <option value="PC">PC</option>
                    <option value="PA">PA</option>
                    <option value="POM">POM</option>
                    <option value="PET">PET</option>
                    <option value="PS">PS</option>
                    <option value="PMMA">PMMA</option>
                    <option value="PVC">PVC</option>
                </select>
                <div class="form-text">คำนวณแบบประมาณการ เพื่อใช้งานหน้างานเร็ว</div>
            </div>

            <button class="btn btn-calculate" type="button" onclick="calculateCooling()">
                <i class="fas fa-calculator me-2"></i>คำนวณ
            </button>

            <div class="result-section" id="result-cool">
                <h5 class="result-title"><i class="fas fa-snowflake me-2"></i>Cooling Time (ประมาณ)</h5>
                <div class="result-value" id="cool-result">-</div>
                <div class="result-unit">sec</div>

                <div class="result-details">
                    <div class="result-row"><span>Thickness</span><span id="cool-thickness-out">-</span></div>
                    <div class="result-row"><span>Material</span><span id="cool-material-out">-</span></div>
                </div>
            </div>
        </section>

        <section class="calculator-panel" id="calc-shot">
            <div class="calc-title"><i class="fas fa-fill-drip"></i>คำนวณ Shot Size</div>

            <div class="mb-3">
                <label class="form-label"><i class="fas fa-weight-hanging me-1"></i>น้ำหนักชิ้นงาน</label>
                <div class="input-group">
                    <input type="number" class="form-control" id="shot-part" placeholder="เช่น 35" title="น้ำหนักชิ้นงาน" inputmode="decimal">
                    <span class="input-group-text">g</span>
                </div>
            </div>

            <div class="mb-3">
                <label class="form-label"><i class="fas fa-project-diagram me-1"></i>น้ำหนัก Runner/Sprue</label>
                <div class="input-group">
                    <input type="number" class="form-control" id="shot-runner" placeholder="เช่น 10" title="น้ำหนัก runner" inputmode="decimal">
                    <span class="input-group-text">g</span>
                </div>
            </div>

            <div class="mb-3">
                <label class="form-label"><i class="fas fa-tint me-1"></i>ความหนาแน่น (Density)</label>
                <div class="input-group">
                    <input type="number" class="form-control" id="shot-density" placeholder="เช่น 1.05" title="ความหนาแน่น" inputmode="decimal" value="1.05">
                    <span class="input-group-text">g/cc</span>
                </div>
            </div>

            <div class="mb-3">
                <label class="form-label"><i class="fas fa-expand-arrows-alt me-1"></i>Cushion (%) <span class="range-readout" id="cushion-value">10</span>%</label>
                <input type="range" class="form-range" id="shot-cushion" min="0" max="30" value="10">
            </div>

            <button class="btn btn-calculate" type="button" onclick="calculateShot()">
                <i class="fas fa-calculator me-2"></i>คำนวณ
            </button>

            <div class="result-section" id="result-shot">
                <h5 class="result-title"><i class="fas fa-fill-drip me-2"></i>Shot Size</h5>
                <div class="result-value" id="shot-result">-</div>
                <div class="result-unit">cc</div>

                <div class="result-details">
                    <div class="result-row"><span>Total weight</span><span id="shot-weight">-</span></div>
                    <div class="result-row"><span>Density</span><span id="shot-density-out">-</span></div>
                    <div class="result-row"><span>Cushion</span><span id="shot-cushion-out">-</span></div>
                </div>
            </div>
        </section>

        <section class="calculator-panel" id="calc-cycle">
            <div class="calc-title"><i class="fas fa-clock"></i>คำนวณ Cycle Time</div>

            <div class="mb-3">
                <label class="form-label"><i class="fas fa-fill-drip me-1"></i>Shot Size (cc)</label>
                <div class="input-group">
                    <input type="number" class="form-control" id="cycle-shot" placeholder="เช่น 50" title="Shot size" inputmode="decimal">
                    <span class="input-group-text">cc</span>
                </div>
            </div>

            <div class="mb-3">
                <label class="form-label"><i class="fas fa-tachometer-alt me-1"></i>Injection Speed (mm/s)</label>
                <div class="input-group">
                    <input type="number" class="form-control" id="cycle-speed" placeholder="เช่น 50" title="Injection speed" inputmode="decimal">
                    <span class="input-group-text">mm/s</span>
                </div>
            </div>

            <div class="mb-3">
                <label class="form-label"><i class="fas fa-snowflake me-1"></i>Cooling Time (sec)</label>
                <div class="input-group">
                    <input type="number" class="form-control" id="cycle-cool" placeholder="เช่น 15" title="Cooling time" inputmode="decimal">
                    <span class="input-group-text">sec</span>
                </div>
            </div>

            <button class="btn btn-calculate" type="button" onclick="calculateCycle()">
                <i class="fas fa-calculator me-2"></i>คำนวณ
            </button>

            <div class="result-section" id="result-cycle">
                <h5 class="result-title"><i class="fas fa-clock me-2"></i>Cycle Time (ประมาณ)</h5>
                <div class="result-value" id="cycle-result">-</div>
                <div class="result-unit">sec</div>

                <div class="result-details">
                    <div class="result-row"><span>Fill time</span><span id="cycle-fill">-</span></div>
                    <div class="result-row"><span>Cooling</span><span id="cycle-cooling">-</span></div>
                    <div class="result-row"><span>Others</span><span id="cycle-others">-</span></div>
                </div>
            </div>
        </section>

        <section class="calculator-panel" id="calc-gate">
            <div class="calc-title"><i class="fas fa-door-open"></i>คำนวณ Gate Size</div>

            <div class="mb-3">
                <label class="form-label"><i class="fas fa-weight-hanging me-1"></i>Part Weight (g)</label>
                <div class="input-group">
                    <input type="number" class="form-control" id="gate-weight" placeholder="เช่น 25" title="Part weight" inputmode="decimal">
                    <span class="input-group-text">g</span>
                </div>
            </div>

            <div class="mb-3">
                <label class="form-label"><i class="fas fa-layer-group me-1"></i>Wall Thickness (mm)</label>
                <div class="input-group">
                    <input type="number" class="form-control" id="gate-thickness" placeholder="เช่น 2" title="Wall thickness" inputmode="decimal">
                    <span class="input-group-text">mm</span>
                </div>
            </div>

            <div class="mb-3">
                <label class="form-label"><i class="fas fa-vial me-1"></i>Material</label>
                <select class="form-select" id="gate-material" title="Material">
                    <option value="PP" selected>PP</option>
                    <option value="ABS">ABS</option>
                    <option value="PC">PC</option>
                    <option value="PA">PA</option>
                </select>
            </div>

            <button class="btn btn-calculate" type="button" onclick="calculateGate()">
                <i class="fas fa-calculator me-2"></i>คำนวณ
            </button>

            <div class="result-section" id="result-gate">
                <h5 class="result-title"><i class="fas fa-door-open me-2"></i>Gate Size</h5>
                <div class="result-value" id="gate-result">-</div>
                <div class="result-unit">mm²</div>

                <div class="result-details">
                    <div class="result-row"><span>Part weight</span><span id="gate-weight-out">-</span></div>
                    <div class="result-row"><span>Thickness</span><span id="gate-thickness-out">-</span></div>
                    <div class="result-row"><span>Material</span><span id="gate-material-out">-</span></div>
                </div>
            </div>
        </section>

        <section class="calculator-panel" id="calc-shrink">
            <div class="calc-title"><i class="fas fa-compress"></i>คำนวณ Shrinkage</div>

            <div class="mb-3">
                <label class="form-label"><i class="fas fa-vial me-1"></i>Material</label>
                <select class="form-select" id="shrink-material" title="Material">
                    <option value="PP" selected>PP</option>
                    <option value="ABS">ABS</option>
                    <option value="PC">PC</option>
                    <option value="PA">PA</option>
                    <option value="POM">POM</option>
                    <option value="PET">PET</option>
                </select>
            </div>

            <div class="mb-3">
                <label class="form-label"><i class="fas fa-layer-group me-1"></i>Wall Thickness (mm)</label>
                <div class="input-group">
                    <input type="number" class="form-control" id="shrink-thickness" placeholder="เช่น 2" title="Wall thickness" inputmode="decimal">
                    <span class="input-group-text">mm</span>
                </div>
            </div>

            <button class="btn btn-calculate" type="button" onclick="calculateShrinkage()">
                <i class="fas fa-calculator me-2"></i>คำนวณ
            </button>

            <div class="result-section" id="result-shrink">
                <h5 class="result-title"><i class="fas fa-compress me-2"></i>Shrinkage Rate</h5>
                <div class="result-value" id="shrink-result">-</div>
                <div class="result-unit">%</div>

                <div class="result-details">
                    <div class="result-row"><span>Material</span><span id="shrink-mat">-</span></div>
                    <div class="result-row"><span>Thickness</span><span id="shrink-thick">-</span></div>
                    <div class="result-row"><span>Direction</span><span id="shrink-dir">-</span></div>
                </div>
            </div>
        </section>

        <section class="calculator-panel" id="calc-temp">
            <div class="calc-title"><i class="fas fa-temperature-high"></i>ข้อมูลอุณหภูมิแนะนำ</div>

            <div class="mb-3">
                <label class="form-label"><i class="fas fa-vial me-1"></i>เลือกวัสดุ</label>
                <select class="form-select" id="temp-material" title="เลือกวัสดุ">
                    <option value="PP">PP</option>
                    <option value="ABS" selected>ABS</option>
                    <option value="PC">PC</option>
                    <option value="PA">PA</option>
                    <option value="POM">POM</option>
                    <option value="PET">PET</option>
                    <option value="PS">PS</option>
                    <option value="PMMA">PMMA</option>
                    <option value="PVC">PVC</option>
                </select>
            </div>

            <button class="btn btn-calculate" type="button" onclick="showMoldTemp()">
                <i class="fas fa-info-circle me-2"></i>แสดงข้อมูล
            </button>

            <div class="result-section" id="result-temp">
                <h5 class="result-title"><i class="fas fa-temperature-high me-2"></i>ช่วงอุณหภูมิแนะนำ</h5>
                <div class="result-details">
                    <div class="result-row"><span>Material</span><span id="temp-mat">-</span></div>
                    <div class="result-row"><span>Mold temp</span><span id="temp-mold">-</span></div>
                    <div class="result-row"><span>Melt temp</span><span id="temp-melt">-</span></div>
                    <div class="result-row"><span>Pressure (approx)</span><span id="temp-press">-</span></div>
                </div>
            </div>
        </section>

        <section class="calculator-panel" id="calc-vp">
            <div class="calc-title"><i class="fas fa-ruler-combined"></i>คำนวณ V-P Position</div>

            <div class="mb-3">
                <label class="form-label"><i class="fas fa-arrows-alt-v me-1"></i>Shot size (Stroke)</label>
                <div class="input-group">
                    <input type="number" class="form-control" id="vp-shot-size" placeholder="เช่น 60" title="Shot stroke" inputmode="decimal">
                    <span class="input-group-text">mm</span>
                </div>
            </div>

            <div class="mb-3">
                <label class="form-label"><i class="fas fa-percentage me-1"></i>% Fill <span class="range-readout" id="fill-value">95</span>%</label>
                <input type="range" class="form-range" id="vp-fill" min="80" max="99" value="95">
            </div>

            <button class="btn btn-calculate" type="button" onclick="calculateVP()">
                <i class="fas fa-calculator me-2"></i>คำนวณ
            </button>

            <div class="result-section" id="result-vp">
                <h5 class="result-title"><i class="fas fa-ruler-combined me-2"></i>V-P Position</h5>
                <div class="result-value" id="vp-result">-</div>
                <div class="result-unit">mm</div>

                <div class="result-details">
                    <div class="result-row"><span>Shot</span><span id="vp-shot">-</span></div>
                    <div class="result-row"><span>% Fill</span><span id="vp-percent">-</span></div>
                    <div class="result-row"><span>Cushion (5%)</span><span id="vp-cushion">-</span></div>
                </div>
            </div>
        </section>

        <section class="calculator-panel" id="calc-machine">
            <div class="calc-title"><i class="fas fa-industry"></i>แนะนำขนาดเครื่อง</div>

            <div class="mb-3">
                <label class="form-label"><i class="fas fa-compress-arrows-alt me-1"></i>แรงปิดที่ต้องการ</label>
                <div class="input-group">
                    <input type="number" class="form-control" id="machine-force" placeholder="เช่น 150" title="แรงปิดที่ต้องการ" inputmode="decimal">
                    <span class="input-group-text">ton</span>
                </div>
            </div>

            <button class="btn btn-calculate" type="button" onclick="calculateMachine()">
                <i class="fas fa-calculator me-2"></i>แนะนำเครื่อง
            </button>

            <div class="result-section" id="result-machine">
                <h5 class="result-title"><i class="fas fa-industry me-2"></i>ขนาดเครื่องแนะนำ</h5>
                <div class="result-value" id="machine-result">-</div>
                <div class="result-unit">ton</div>

                <div class="result-details">
                    <div class="result-row"><span>แรงปิดที่ต้องการ</span><span id="machine-need">-</span></div>
                    <div class="result-row"><span>% การใช้งาน</span><span id="machine-usage">-</span></div>
                </div>

                <div class="recommendation">
                    <i class="fas fa-check-circle"></i>
                    <span>เครื่องขนาด <span id="machine-size">-</span> ton เหมาะสม</span>
                </div>
            </div>
        </section>

        <section class="calculator-panel" id="calc-vision">
            <div class="calc-title"><i class="fas fa-eye"></i>Vision AI - วินิจฉัยภาพ</div>

            <div class="mb-3">
                <label class="form-label"><i class="fas fa-camera me-1"></i>อัปโหลดรูปชิ้นงาน</label>
                <input type="file" class="form-control" id="vision-file" accept="image/*" title="Upload image">
                <div class="form-text">รองรับ JPG, PNG, WebP (max 5MB)</div>
            </div>

            <div class="mb-3">
                <label class="form-label"><i class="fas fa-question-circle me-1"></i>ปัญหาที่สงสัย</label>
                <select class="form-select" id="vision-problem" title="Problem type">
                    <option value="auto">ตรวจสอบอัตโนมัติ</option>
                    <option value="shortshot">Short Shot</option>
                    <option value="flash">Flash</option>
                    <option value="sink">Sink Marks</option>
                    <option value="warp">Warpage</option>
                    <option value="burn">Burn Marks</option>
                </select>
            </div>

            <button class="btn btn-calculate" type="button" onclick="analyzeVision()">
                <i class="fas fa-robot me-2"></i>วิเคราะห์ด้วย AI
            </button>

            <div class="result-section" id="result-vision">
                <h5 class="result-title"><i class="fas fa-eye me-2"></i>ผลการวิเคราะห์ Vision AI</h5>
                <div class="result-details">
                    <div class="result-row"><span>ปัญหาที่ตรวจพบ</span><span id="vision-problem-out">-</span></div>
                    <div class="result-row"><span>ความมั่นใจ</span><span id="vision-confidence">-</span></div>
                    <div class="result-row"><span>คำแนะนำ</span><span id="vision-advice">-</span></div>
                </div>
            </div>
        </section>
            <h5>🔧 ใหม่! WiT Kaizen Expert</h5>
            <p class="mb-2">AI ที่ปรึกษาด้าน Kaizen ช่วยปรับปรุงงานหน้างานจริง</p>
            <div class="kaizen-features">
                <span class="kaizen-tag">🔍 3-Mu's Analysis</span>
                <span class="kaizen-tag">📊 4M Checklist</span>
                <span class="kaizen-tag">🔧 TPM Guide</span>
                <span class="kaizen-tag">📋 5S / 5ส</span>
                <span class="kaizen-tag">⚡ JIT</span>
            </div>
            <a href="https://lin.ee/TipxyCa" target="_blank" rel="noopener" class="btn btn-light btn-sm mt-3 btn-kaizen">
                <i class="fab fa-line me-1"></i> ลองใช้ Kaizen Expert
            </a>
        </div>
    </main>

    <div class="line-modal-overlay" id="lineModal">
        <div class="line-modal">
            <div class="line-modal-icon"><i class="fab fa-line"></i></div>
            <h3 class="mb-2">🎉 ใช้ครบ 15 ครั้งแล้ว!</h3>
            <p class="mb-2">เพิ่มเพื่อน LINE เพื่อใช้งานต่อได้ <strong>ไม่จำกัด</strong><br>พร้อมฟีเจอร์พิเศษอีกมากมาย!</p>

            <div class="modal-benefits">
                <h5 class="mb-2">✨ สิทธิพิเศษสำหรับเพื่อน LINE:</h5>
                <div class="benefit-item"><i class="fas fa-eye"></i><span>Vision AI วินิจฉัยภาพ</span></div>
                <div class="benefit-item"><i class="fas fa-brain"></i><span>AI Expert ฉีดพลาสติก</span></div>
                <div class="benefit-item"><i class="fas fa-chart-line"></i><span>Dashboard ประสิทธิภาพ</span></div>
                <div class="benefit-item"><i class="fas fa-tools"></i><span>10+ เครื่องมือคำนวณ</span></div>
            </div>

            <a href="https://lin.ee/TipxyCa" target="_blank" rel="noopener" class="btn-line-login">
                <i class="fab fa-line"></i> เพิ่มเพื่อน LINE ฟรี!
            </a>

            <p class="modal-smallprint"><i class="fas fa-shield-alt me-1"></i> ปลอดภัย ไม่มีค่าใช้จ่าย</p>
        </div>
    </div>

    <footer class="app-footer">
        <p>© 2025 Wizmobiz | พัฒนาโดย อ.วิทยา</p>
        <p><a href="injection-molding.html" class="footer-link">กลับหน้าหลัก</a></p>
    </footer>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script>
        const TRIAL_KEY = 'wizmobiz_calc_trial';
        const MAX_FREE_TRIALS = 15;
        const LINE_FRIEND_KEY = 'wizmobiz_line_friend';

        const materials = {
            PP: { pressure: 35, mold: [20, 60, 40], melt: '180-230', alpha: 0.12, shrinkage: [1.5, 2.0, 2.5] },
            ABS: { pressure: 40, mold: [40, 80, 60], melt: '220-260', alpha: 0.095, shrinkage: [0.4, 0.6, 0.8] },
            PC: { pressure: 50, mold: [80, 120, 100], melt: '280-320', alpha: 0.073, shrinkage: [0.5, 0.7, 0.9] },
            PA: { pressure: 45, mold: [60, 100, 80], melt: '250-300', alpha: 0.09, shrinkage: [0.8, 1.2, 1.6] },
            POM: { pressure: 45, mold: [60, 120, 90], melt: '180-210', alpha: 0.085, shrinkage: [1.8, 2.2, 2.6] },
            PET: { pressure: 45, mold: [15, 50, 30], melt: '260-280', alpha: 0.08, shrinkage: [0.3, 0.5, 0.7] },
            PS: { pressure: 35, mold: [20, 50, 35], melt: '180-260', alpha: 0.075, shrinkage: [0.3, 0.5, 0.7] },
            PMMA: { pressure: 45, mold: [50, 80, 65], melt: '220-260', alpha: 0.073, shrinkage: [0.3, 0.5, 0.7] },
            PVC: { pressure: 35, mold: [20, 60, 40], melt: '160-200', alpha: 0.08, shrinkage: [0.2, 0.4, 0.6] },
        };

        const machineSizes = [50, 80, 100, 120, 150, 180, 200, 250, 300, 350, 400, 450, 500, 550, 650, 850, 1000, 1300, 1600, 2000];

        function getTrialCount() {
            const stored = localStorage.getItem(TRIAL_KEY);
            if (!stored) {
                localStorage.setItem(TRIAL_KEY, MAX_FREE_TRIALS.toString());
                return MAX_FREE_TRIALS;
            }
            const parsed = parseInt(stored, 10);
            return Number.isFinite(parsed) ? parsed : MAX_FREE_TRIALS;
        }

        function setTrialCount(count) {
            const safe = Math.max(0, Math.floor(count));
            localStorage.setItem(TRIAL_KEY, safe.toString());
        }

        function checkLineCallback() {
            const params = new URLSearchParams(window.location.search);
            if (params.get('line_friend') === 'true') {
                localStorage.setItem(LINE_FRIEND_KEY, 'true');
            }
        }

        function isLineFriend() {
            return localStorage.getItem(LINE_FRIEND_KEY) === 'true';
        }

        function showLineModal() {
            const modal = document.getElementById('lineModal');
            if (modal) modal.style.display = 'flex';
        }

        function updateTrialBadge() {
            const badge = document.getElementById('trialBadge');
            const text = document.getElementById('trialText');
            if (!badge || !text) return;

            badge.classList.remove('premium', 'exhausted');

            if (isLineFriend()) {
                badge.classList.add('premium');
                text.textContent = 'LINE Friend (ไม่จำกัด)';
                return;
            }

            const remaining = getTrialCount();
            text.textContent = `ฟรี ${remaining}/${MAX_FREE_TRIALS}`;
            if (remaining <= 0) badge.classList.add('exhausted');
        }

        function useTrialCredit() {
            if (isLineFriend()) return true;

            const remaining = getTrialCount();
            if (remaining <= 0) {
                updateTrialBadge();
                showLineModal();
                return false;
            }

            setTrialCount(remaining - 1);
            updateTrialBadge();
            if (remaining - 1 <= 0) showLineModal();
            return true;
        }

        function calculateClamping() {
            if (!useTrialCredit()) return;

            const area = parseFloat(document.getElementById('clamp-area').value);
            const pressure = parseFloat(document.getElementById('clamp-pressure').value);
            const safety = parseFloat(document.getElementById('clamp-safety').value);

            if (!area || area <= 0 || !pressure || pressure <= 0 || !safety || safety <= 0) {
                alert('กรุณากรอกข้อมูลให้ครบถ้วน');
                return;
            }

            const ton = (area * pressure * safety) / 1000;
            document.getElementById('clamp-result').textContent = ton.toFixed(1);
            document.getElementById('clamp-area-out').textContent = `${area} cm²`;
            document.getElementById('clamp-pressure-out').textContent = `${pressure} kg/cm²`;
            document.getElementById('clamp-safety-out').textContent = safety.toFixed(2);
            document.getElementById('result-clamp').classList.add('show');
        }

        function calculateCooling() {
            if (!useTrialCredit()) return;

            const thicknessMm = parseFloat(document.getElementById('cool-thickness').value);
            const materialKey = document.getElementById('cool-material').value;
            const mat = materials[materialKey];

            if (!thicknessMm || thicknessMm <= 0 || !mat) {
                alert('กรุณากรอกข้อมูลให้ครบถ้วน');
                return;
            }

            const thicknessM = thicknessMm / 1000;
            const alpha = mat.alpha;
            const moldAvg = mat.mold[2];
            const meltParts = mat.melt.split('-').map(v => parseFloat(v));
            const meltMid = (meltParts[0] + meltParts[1]) / 2;
            const ejectTemp = moldAvg + 20;
            const numerator = Math.max(1e-6, meltMid - moldAvg);
            const denominator = Math.max(1e-6, ejectTemp - moldAvg);
            const lnTerm = Math.log(numerator / denominator);
            const seconds = ((thicknessM * thicknessM) / (Math.PI * Math.PI * alpha)) * Math.max(0.2, lnTerm);
            const out = Math.max(0, seconds);

            document.getElementById('cool-result').textContent = out.toFixed(1);
            document.getElementById('cool-thickness-out').textContent = `${thicknessMm} mm`;
            document.getElementById('cool-material-out').textContent = materialKey;
            document.getElementById('result-cool').classList.add('show');
        }

        function calculateShot() {
            if (!useTrialCredit()) return;

            const part = parseFloat(document.getElementById('shot-part').value);
            const runner = parseFloat(document.getElementById('shot-runner').value);
            const density = parseFloat(document.getElementById('shot-density').value);
            const cushionPct = parseFloat(document.getElementById('shot-cushion').value);

            if (!part || part <= 0 || runner < 0 || !density || density <= 0) {
                alert('กรุณากรอกข้อมูลให้ครบถ้วน');
                return;
            }

            const totalWeight = part + (runner || 0);
            const baseCc = totalWeight / density;
            const cc = baseCc * (1 + (cushionPct / 100));

            document.getElementById('shot-result').textContent = cc.toFixed(1);
            document.getElementById('shot-weight').textContent = `${totalWeight.toFixed(1)} g`;
            document.getElementById('shot-density-out').textContent = `${density} g/cc`;
            document.getElementById('shot-cushion-out').textContent = `${cushionPct}%`;
            document.getElementById('result-shot').classList.add('show');
        }

        function showMoldTemp() {
            if (!useTrialCredit()) return;

            const key = document.getElementById('temp-material').value;
            const mat = materials[key];
            if (!mat) return;

            document.getElementById('temp-mat').textContent = key;
            document.getElementById('temp-mold').textContent = `${mat.mold[0]}-${mat.mold[1]} °C (แนะนำ ~${mat.mold[2]}°C)`;
            document.getElementById('temp-melt').textContent = `${mat.melt} °C`;
            document.getElementById('temp-press').textContent = `${mat.pressure} kg/cm²`;
            document.getElementById('result-temp').classList.add('show');
        }

        function calculateCycle() {
            if (!useTrialCredit()) return;

            const shotSize = parseFloat(document.getElementById('cycle-shot').value);
            const injectionSpeed = parseFloat(document.getElementById('cycle-speed').value);
            const coolingTime = parseFloat(document.getElementById('cycle-cool').value);

            if (!shotSize || shotSize <= 0 || !injectionSpeed || injectionSpeed <= 0 || !coolingTime || coolingTime <= 0) {
                alert('กรุณากรอกข้อมูลให้ครบถ้วน');
                return;
            }

            // ประมาณ fill time จาก shot size และ speed
            const fillTime = (shotSize / injectionSpeed) * 60; // วินาที
            const otherTime = 5; // packing, ejection, etc.
            const totalCycle = fillTime + coolingTime + otherTime;

            document.getElementById('cycle-result').textContent = totalCycle.toFixed(1);
            document.getElementById('cycle-fill').textContent = `${fillTime.toFixed(1)} sec`;
            document.getElementById('cycle-cooling').textContent = `${coolingTime} sec`;
            document.getElementById('cycle-others').textContent = `${otherTime} sec`;
            document.getElementById('result-cycle').classList.add('show');
        }

        function calculateGate() {
            if (!useTrialCredit()) return;

            const partWeight = parseFloat(document.getElementById('gate-weight').value);
            const thickness = parseFloat(document.getElementById('gate-thickness').value);
            const material = document.getElementById('gate-material').value;

            if (!partWeight || partWeight <= 0 || !thickness || thickness <= 0) {
                alert('กรุณากรอกข้อมูลให้ครบถ้วน');
                return;
            }

            // ประมาณ gate size จากน้ำหนักและความหนา
            const gateSize = Math.sqrt((partWeight * 1000) / (thickness * 2.5)); // mm²

            document.getElementById('gate-result').textContent = gateSize.toFixed(1);
            document.getElementById('gate-weight-out').textContent = `${partWeight} g`;
            document.getElementById('gate-thickness-out').textContent = `${thickness} mm`;
            document.getElementById('gate-material-out').textContent = material;
            document.getElementById('result-gate').classList.add('show');
        }

        function calculateShrinkage() {
            if (!useTrialCredit()) return;

            const material = document.getElementById('shrink-material').value;
            const thickness = parseFloat(document.getElementById('shrink-thickness').value);

            if (!thickness || thickness <= 0) {
                alert('กรุณากรอกความหนา');
                return;
            }

            const mat = materials[material];
            if (!mat || !mat.shrinkage) return;

            // เลือก shrinkage ตามความหนา
            let shrinkage;
            if (thickness < 2) shrinkage = mat.shrinkage[0];
            else if (thickness < 4) shrinkage = mat.shrinkage[1];
            else shrinkage = mat.shrinkage[2];

            document.getElementById('shrink-result').textContent = shrinkage.toFixed(1);
            document.getElementById('shrink-mat').textContent = material;
            document.getElementById('shrink-thick').textContent = `${thickness} mm`;
            document.getElementById('shrink-dir').textContent = 'Flow direction';
            document.getElementById('result-shrink').classList.add('show');
        }

        function analyzeVision() {
            if (!useTrialCredit()) return;

            const fileInput = document.getElementById('vision-file');
            const problem = document.getElementById('vision-problem').value;

            if (!fileInput.files[0]) {
                alert('กรุณาอัปโหลดรูปภาพ');
                return;
            }

            // Mock AI analysis (ในความเป็นจริงจะส่งไป LINE OA)
            const problems = {
                auto: 'Short Shot',
                shortshot: 'Short Shot',
                flash: 'Flash',
                sink: 'Sink Marks',
                warp: 'Warpage',
                burn: 'Burn Marks'
            };

            const selectedProblem = problems[problem] || 'Unknown';
            const confidence = Math.floor(Math.random() * 20) + 80; // 80-99%

            document.getElementById('vision-problem-out').textContent = selectedProblem;
            document.getElementById('vision-confidence').textContent = `${confidence}%`;
            document.getElementById('vision-advice').textContent = 'ปรับ injection pressure +10%';
            document.getElementById('result-vision').classList.add('show');
        }

        function calculateMachine() {
            if (!useTrialCredit()) return;

            const force = parseFloat(document.getElementById('machine-force').value);
            if (!force || force <= 0) {
                alert('กรุณากรอกแรงปิดที่ต้องการ');
                return;
            }

            const recommendedMachine = machineSizes.find(size => size >= force) || 2000;
            const usage = ((force / recommendedMachine) * 100).toFixed(0);

            document.getElementById('machine-result').textContent = recommendedMachine;
            document.getElementById('machine-need').textContent = `${force} ton`;
            document.getElementById('machine-usage').textContent = `${usage}%`;
            document.getElementById('machine-size').textContent = recommendedMachine;
            document.getElementById('result-machine').classList.add('show');
        }

        document.querySelectorAll('.calc-tab').forEach(tab => {
            tab.addEventListener('click', function () {
                document.querySelectorAll('.calc-tab').forEach(t => t.classList.remove('active'));
                this.classList.add('active');

                document.querySelectorAll('.calculator-panel').forEach(p => p.classList.remove('active'));
                document.getElementById('calc-' + this.dataset.calc).classList.add('active');
            });
        });

        document.querySelectorAll('.material-pills').forEach(container => {
            container.querySelectorAll('.material-pill').forEach(pill => {
                pill.addEventListener('click', function () {
                    container.querySelectorAll('.material-pill').forEach(p => p.classList.remove('active'));
                    this.classList.add('active');
                    if (this.dataset.pressure) {
                        document.getElementById('clamp-pressure').value = this.dataset.pressure;
                    }
                });
            });
        });

        document.getElementById('shot-cushion').addEventListener('input', function () {
            document.getElementById('cushion-value').textContent = this.value;
        });

        document.getElementById('vp-fill').addEventListener('input', function () {
            document.getElementById('fill-value').textContent = this.value;
        });

        document.addEventListener('DOMContentLoaded', function () {
            checkLineCallback();
            updateTrialBadge();
        });
    </script>
</body>

</html>
