<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="WiT Marketplace - ‡∏ï‡∏•‡∏≤‡∏î‡∏ã‡∏∑‡πâ‡∏≠‡∏Ç‡∏≤‡∏¢‡∏≠‡∏≠‡∏ô‡πÑ‡∏•‡∏ô‡πå C2C ‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠‡∏ú‡∏π‡πâ‡∏ã‡∏∑‡πâ‡∏≠‡∏ú‡∏π‡πâ‡∏Ç‡∏≤‡∏¢‡∏ú‡πà‡∏≤‡∏ô LINE">
    <meta name="keywords" content="WiT, Marketplace, ‡∏ã‡∏∑‡πâ‡∏≠‡∏Ç‡∏≤‡∏¢, C2C, LINE, ‡∏ï‡∏•‡∏≤‡∏î‡∏≠‡∏≠‡∏ô‡πÑ‡∏•‡∏ô‡πå">
    <title>WiT Marketplace - ‡∏ï‡∏•‡∏≤‡∏î‡∏ã‡∏∑‡πâ‡∏≠‡∏Ç‡∏≤‡∏¢‡∏≠‡∏≠‡∏ô‡πÑ‡∏•‡∏ô‡πå</title>
    
    <!-- Firebase SDK -->
    <script src="https://www.gstatic.com/firebasejs/10.7.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.0/firebase-firestore-compat.js"></script>
    
    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <!-- AOS CSS -->
    <link href="https://unpkg.com/aos@2.3.1/dist/aos.css" rel="stylesheet">
    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Kanit:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    
    <style>
        :root {
            --primary: #FF5722;
            --primary-dark: #E64A19;
            --primary-light: #FFCCBC;
            --secondary: #2196F3;
            --success: #4CAF50;
            --warning: #FF9800;
            --dark: #212121;
            --light: #FAFAFA;
            --gray: #757575;
            --border: #E0E0E0;
            --gradient-primary: linear-gradient(135deg, #FF5722 0%, #E64A19 100%);
            --gradient-secondary: linear-gradient(135deg, #2196F3 0%, #1976D2 100%);
            --gradient-success: linear-gradient(135deg, #00C300 0%, #00A000 100%);
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Kanit', sans-serif;
            background: linear-gradient(180deg, #f5f7fa 0%, #e4e8eb 100%);
            min-height: 100vh;
            color: var(--dark);
        }
        
        /* Header */
        .header {
            background: var(--gradient-primary);
            color: white;
            position: sticky;
            top: 0;
            z-index: 1000;
            box-shadow: 0 2px 20px rgba(0,0,0,0.15);
        }
        
        .header-top {
            padding: 15px 0;
        }
        
        .logo {
            font-size: 1.8rem;
            font-weight: 700;
            text-decoration: none;
            color: white;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .logo:hover {
            color: #FFE0B2;
        }
        
        .logo i {
            font-size: 2rem;
        }
        
        .header-actions {
            display: flex;
            align-items: center;
            gap: 15px;
        }
        
        .btn-sell {
            background: var(--gradient-success);
            color: white;
            border: none;
            padding: 10px 25px;
            border-radius: 30px;
            font-weight: 600;
            text-decoration: none;
            display: flex;
            align-items: center;
            gap: 8px;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(0, 195, 0, 0.3);
        }
        
        .btn-sell:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 25px rgba(0, 195, 0, 0.4);
            color: white;
        }
        
        .nav-link-header {
            color: white;
            text-decoration: none;
            padding: 8px 15px;
            border-radius: 8px;
            transition: all 0.3s;
            font-weight: 500;
        }
        
        .nav-link-header:hover {
            background: rgba(255,255,255,0.1);
            color: white;
        }
        
        /* Search Section */
        .search-section {
            background: white;
            padding: 20px 0;
            border-bottom: 1px solid var(--border);
        }
        
        .search-container {
            max-width: 700px;
            margin: 0 auto;
        }
        
        .search-box {
            display: flex;
            background: var(--light);
            border-radius: 50px;
            padding: 5px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.08);
        }
        
        .search-input {
            flex: 1;
            border: none;
            background: transparent;
            padding: 12px 20px;
            font-size: 1rem;
            outline: none;
        }
        
        .search-btn {
            background: var(--gradient-primary);
            color: white;
            border: none;
            padding: 12px 30px;
            border-radius: 30px;
            cursor: pointer;
            font-weight: 500;
            transition: all 0.3s;
        }
        
        .search-btn:hover {
            transform: scale(1.05);
        }
        
        /* Category Tabs */
        .category-section {
            background: white;
            padding: 15px 0;
            overflow-x: auto;
            white-space: nowrap;
            -webkit-overflow-scrolling: touch;
        }
        
        .category-tabs {
            display: flex;
            gap: 10px;
            padding: 0 15px;
        }
        
        .category-tab {
            padding: 10px 25px;
            background: var(--light);
            border: 2px solid transparent;
            border-radius: 30px;
            cursor: pointer;
            font-weight: 500;
            transition: all 0.3s;
            white-space: nowrap;
            color: var(--gray);
        }
        
        .category-tab:hover {
            border-color: var(--primary-light);
            color: var(--primary);
        }
        
        .category-tab.active {
            background: var(--gradient-primary);
            color: white;
            border-color: transparent;
        }
        
        .category-tab i {
            margin-right: 5px;
        }
        
        /* Stats Banner */
        .stats-banner {
            background: var(--gradient-secondary);
            color: white;
            padding: 15px 0;
        }
        
        .stats-container {
            display: flex;
            justify-content: center;
            gap: 50px;
            flex-wrap: wrap;
        }
        
        .stat-item {
            text-align: center;
        }
        
        .stat-number {
            font-size: 1.8rem;
            font-weight: 700;
        }
        
        .stat-label {
            font-size: 0.9rem;
            opacity: 0.9;
        }
        
        /* Main Content */
        .main-content {
            padding: 30px 0;
            min-height: 60vh;
        }
        
        .section-title {
            font-size: 1.5rem;
            font-weight: 600;
            margin-bottom: 25px;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .section-title i {
            color: var(--primary);
        }
        
        /* Product Grid */
        .product-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
            gap: 25px;
        }
        
        .product-card {
            background: white;
            border-radius: 16px;
            overflow: hidden;
            box-shadow: 0 5px 20px rgba(0,0,0,0.08);
            transition: all 0.3s ease;
            cursor: pointer;
        }
        
        .product-card:hover {
            transform: translateY(-8px);
            box-shadow: 0 15px 40px rgba(0,0,0,0.15);
        }
        
        .product-image {
            position: relative;
            width: 100%;
            aspect-ratio: 1;
            overflow: hidden;
            background: linear-gradient(135deg, #f5f5f5 0%, #e0e0e0 100%);
        }
        
        .product-image img {
            width: 100%;
            height: 100%;
            object-fit: cover;
            transition: transform 0.5s ease;
        }
        
        .product-card:hover .product-image img {
            transform: scale(1.08);
        }
        
        .product-badge {
            position: absolute;
            top: 10px;
            left: 10px;
            padding: 5px 12px;
            border-radius: 20px;
            font-size: 0.75rem;
            font-weight: 600;
        }
        
        .badge-new {
            background: var(--success);
            color: white;
        }
        
        .badge-hot {
            background: var(--warning);
            color: white;
        }
        
        .badge-sold {
            background: var(--gray);
            color: white;
        }
        
        .product-info {
            padding: 15px;
        }
        
        .product-name {
            font-weight: 600;
            font-size: 1rem;
            color: var(--dark);
            margin-bottom: 8px;
            display: -webkit-box;
            -webkit-line-clamp: 2;
            -webkit-box-orient: vertical;
            overflow: hidden;
            line-height: 1.4;
            height: 2.8em;
        }
        
        .product-price {
            font-size: 1.3rem;
            font-weight: 700;
            color: var(--primary);
            margin-bottom: 8px;
        }
        
        .product-meta {
            display: flex;
            justify-content: space-between;
            align-items: center;
            color: var(--gray);
            font-size: 0.85rem;
        }
        
        .product-seller {
            display: flex;
            align-items: center;
            gap: 5px;
        }
        
        .product-views {
            display: flex;
            align-items: center;
            gap: 5px;
        }
        
        /* Loading State */
        .loading-container {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            padding: 60px;
        }
        
        .spinner {
            width: 50px;
            height: 50px;
            border: 4px solid var(--border);
            border-top-color: var(--primary);
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }
        
        @keyframes spin {
            to { transform: rotate(360deg); }
        }
        
        /* Empty State */
        .empty-state {
            text-align: center;
            padding: 60px 20px;
            color: var(--gray);
        }
        
        .empty-state i {
            font-size: 4rem;
            margin-bottom: 20px;
            color: var(--border);
        }
        
        .empty-state h3 {
            margin-bottom: 10px;
            color: var(--dark);
        }
        
        /* Footer */
        .footer {
            background: var(--dark);
            color: white;
            padding: 50px 0 30px;
        }
        
        .footer-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 40px;
            margin-bottom: 40px;
        }
        
        .footer-section h4 {
            font-weight: 600;
            margin-bottom: 20px;
            color: var(--primary);
        }
        
        .footer-section a {
            color: rgba(255,255,255,0.8);
            text-decoration: none;
            display: block;
            margin-bottom: 10px;
            transition: color 0.3s;
        }
        
        .footer-section a:hover {
            color: var(--primary);
        }
        
        .social-links {
            display: flex;
            gap: 15px;
            margin-top: 15px;
        }
        
        .social-links a {
            width: 45px;
            height: 45px;
            background: rgba(255,255,255,0.1);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.2rem;
            transition: all 0.3s;
        }
        
        .social-links a:hover {
            background: var(--primary);
            transform: translateY(-3px);
        }
        
        .footer-bottom {
            text-align: center;
            padding-top: 30px;
            border-top: 1px solid rgba(255,255,255,0.1);
        }
        
        /* Scroll to Top */
        .scroll-top {
            position: fixed;
            bottom: 30px;
            right: 30px;
            width: 50px;
            height: 50px;
            background: var(--gradient-primary);
            color: white;
            border: none;
            border-radius: 50%;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.2rem;
            box-shadow: 0 5px 20px rgba(255, 87, 34, 0.4);
            opacity: 0;
            visibility: hidden;
            transition: all 0.3s;
            z-index: 999;
        }
        
        .scroll-top.visible {
            opacity: 1;
            visibility: visible;
        }
        
        .scroll-top:hover {
            transform: translateY(-3px);
        }
        
        /* AI Generator Button */
        .ai-generator-btn {
            position: fixed;
            bottom: 100px;
            right: 30px;
            width: 60px;
            height: 60px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            border-radius: 50%;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
            box-shadow: 0 5px 25px rgba(102, 126, 234, 0.5);
            transition: all 0.3s;
            z-index: 998;
            animation: pulse-ai 2s infinite;
        }
        
        @keyframes pulse-ai {
            0%, 100% { box-shadow: 0 5px 25px rgba(102, 126, 234, 0.5); }
            50% { box-shadow: 0 5px 35px rgba(102, 126, 234, 0.8); }
        }
        
        .ai-generator-btn:hover {
            transform: scale(1.1);
        }
        
        /* AI Modal Styles */
        .ai-modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.6);
            backdrop-filter: blur(5px);
            z-index: 2000;
            display: none;
            align-items: center;
            justify-content: center;
            padding: 20px;
        }
        
        .ai-modal-overlay.show {
            display: flex;
        }
        
        .ai-modal {
            background: white;
            border-radius: 20px;
            max-width: 500px;
            width: 100%;
            max-height: 90vh;
            overflow-y: auto;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
            animation: slideUp 0.3s ease;
        }
        
        @keyframes slideUp {
            from { opacity: 0; transform: translateY(30px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .ai-modal-header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 25px;
            border-radius: 20px 20px 0 0;
            text-align: center;
        }
        
        .ai-modal-header h3 {
            margin: 0 0 5px 0;
            font-weight: 600;
        }
        
        .ai-modal-header p {
            margin: 0;
            opacity: 0.9;
            font-size: 0.9rem;
        }
        
        .ai-modal-body {
            padding: 25px;
        }
        
        .ai-upload-area {
            border: 3px dashed #e0e0e0;
            border-radius: 16px;
            padding: 40px 20px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s;
            background: #fafafa;
        }
        
        .ai-upload-area:hover {
            border-color: #667eea;
            background: #f5f7ff;
        }
        
        .ai-upload-area.drag-over {
            border-color: #667eea;
            background: #f0f3ff;
        }
        
        .ai-upload-icon {
            font-size: 3rem;
            color: #667eea;
            margin-bottom: 15px;
        }
        
        .ai-upload-text {
            color: #666;
            font-size: 1rem;
        }
        
        .ai-upload-text small {
            display: block;
            margin-top: 8px;
            color: #999;
        }
        
        .ai-preview-container {
            display: none;
            margin-top: 20px;
        }
        
        .ai-preview-image {
            width: 100%;
            max-height: 200px;
            object-fit: contain;
            border-radius: 12px;
            background: #f5f5f5;
        }
        
        .ai-extra-info {
            margin-top: 20px;
        }
        
        .ai-extra-info label {
            font-weight: 500;
            color: #333;
            margin-bottom: 8px;
            display: block;
        }
        
        .ai-extra-info textarea {
            width: 100%;
            border: 2px solid #e0e0e0;
            border-radius: 10px;
            padding: 12px;
            font-size: 0.95rem;
            resize: none;
            transition: border-color 0.3s;
        }
        
        .ai-extra-info textarea:focus {
            outline: none;
            border-color: #667eea;
        }
        
        .ai-generate-btn {
            width: 100%;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            padding: 15px;
            border-radius: 12px;
            font-size: 1.1rem;
            font-weight: 600;
            cursor: pointer;
            margin-top: 20px;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            transition: all 0.3s;
        }
        
        .ai-generate-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(102, 126, 234, 0.4);
        }
        
        .ai-generate-btn:disabled {
            background: #ccc;
            cursor: not-allowed;
            transform: none;
            box-shadow: none;
        }
        
        /* AI Result */
        .ai-result {
            display: none;
            margin-top: 20px;
            background: linear-gradient(135deg, #f5f7fa 0%, #e8ecf5 100%);
            border-radius: 16px;
            padding: 20px;
            border-left: 5px solid #667eea;
        }
        
        .ai-result-header {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 15px;
        }
        
        .ai-result-header i {
            font-size: 1.5rem;
            color: #667eea;
        }
        
        .ai-result-header h4 {
            margin: 0;
            color: #333;
        }
        
        .ai-product-info {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 10px;
            margin-bottom: 15px;
        }
        
        .ai-info-item {
            background: white;
            padding: 10px 12px;
            border-radius: 8px;
        }
        
        .ai-info-item label {
            font-size: 0.75rem;
            color: #888;
            display: block;
        }
        
        .ai-info-item span {
            font-weight: 600;
            color: #333;
        }
        
        .ai-info-item.price span {
            color: #FF5722;
        }
        
        .ai-post-content {
            background: white;
            padding: 15px;
            border-radius: 12px;
            margin-bottom: 15px;
        }
        
        .ai-post-title {
            font-weight: 600;
            color: #333;
            margin-bottom: 10px;
            font-size: 1.1rem;
        }
        
        .ai-post-description {
            color: #555;
            line-height: 1.6;
            margin-bottom: 10px;
        }
        
        .ai-post-cta {
            color: #4CAF50;
            font-weight: 600;
        }
        
        .ai-post-hashtags {
            color: #2196F3;
            font-size: 0.9rem;
            margin-top: 10px;
        }
        
        .ai-actions {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 10px;
        }
        
        .ai-copy-btn {
            background: #4CAF50;
            color: white;
            border: none;
            padding: 12px;
            border-radius: 10px;
            font-weight: 600;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            transition: all 0.3s;
        }
        
        .ai-copy-btn:hover {
            background: #43A047;
        }
        
        .ai-copy-btn.copied {
            background: #2E7D32;
        }
        
        .ai-share-btn {
            background: var(--gradient-success);
            color: white;
            border: none;
            padding: 12px;
            border-radius: 10px;
            font-weight: 600;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            transition: all 0.3s;
        }
        
        .ai-share-btn:hover {
            transform: translateY(-2px);
        }
        
        .ai-new-btn {
            width: 100%;
            background: #f5f5f5;
            color: #666;
            border: none;
            padding: 12px;
            border-radius: 10px;
            font-weight: 500;
            cursor: pointer;
            margin-top: 10px;
            transition: all 0.3s;
        }
        
        .ai-new-btn:hover {
            background: #e0e0e0;
        }
        
        .ai-modal-close {
            position: absolute;
            top: 15px;
            right: 20px;
            background: rgba(255,255,255,0.2);
            border: none;
            color: white;
            width: 35px;
            height: 35px;
            border-radius: 50%;
            cursor: pointer;
            font-size: 1.2rem;
            transition: all 0.3s;
        }
        
        .ai-modal-close:hover {
            background: rgba(255,255,255,0.3);
        }
        
        /* Loading Animation */
        .ai-loading {
            display: none;
            text-align: center;
            padding: 30px;
        }
        
        .ai-loading-spinner {
            width: 60px;
            height: 60px;
            border: 4px solid #e0e0e0;
            border-top-color: #667eea;
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin: 0 auto 15px;
        }
        
        @keyframes spin {
            to { transform: rotate(360deg); }
        }
        
        /* Toast Notification */
        .ai-toast {
            position: fixed;
            bottom: 30px;
            left: 50%;
            transform: translateX(-50%) translateY(100px);
            background: #333;
            color: white;
            padding: 15px 30px;
            border-radius: 50px;
            font-weight: 500;
            z-index: 3000;
            opacity: 0;
            transition: all 0.3s;
        }
        
        .ai-toast.show {
            opacity: 1;
            transform: translateX(-50%) translateY(0);
        }
        
        .ai-toast.success {
            background: #4CAF50;
        }
        
        /* Responsive */
        @media (max-width: 768px) {
            .logo {
                font-size: 1.4rem;
            }
            
            .logo i {
                font-size: 1.5rem;
            }
            
            .btn-sell span {
                display: none;
            }
            
            .btn-sell {
                padding: 10px 15px;
            }
            
            .stats-container {
                gap: 25px;
            }
            
            .stat-number {
                font-size: 1.4rem;
            }
            
            .product-grid {
                grid-template-columns: repeat(2, 1fr);
                gap: 15px;
            }
            
            .product-price {
                font-size: 1.1rem;
            }
            
            .product-name {
                font-size: 0.9rem;
            }
        }
        
        @media (max-width: 480px) {
            .product-grid {
                grid-template-columns: repeat(2, 1fr);
                gap: 10px;
            }
            
            .product-info {
                padding: 10px;
            }
        }
    </style>
</head>
<body>
    <!-- Header -->
    <header class="header">
        <div class="header-top">
            <div class="container">
                <div class="d-flex justify-content-between align-items-center">
                    <a href="index.html" class="logo">
                        <i class="fas fa-store"></i>
                        <span>WiT Marketplace</span>
                    </a>
                    <div class="header-actions">
                        <a href="index.html" class="nav-link-header d-none d-md-inline">
                            <i class="fas fa-home"></i> ‡∏´‡∏ô‡πâ‡∏≤‡πÅ‡∏£‡∏Å
                        </a>
                        <a href="post-product.html" class="btn-sell">
                            <i class="fas fa-plus-circle"></i>
                            <span>‡∏•‡∏á‡∏Ç‡∏≤‡∏¢‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤</span>
                        </a>
                    </div>
                </div>
            </div>
        </div>
    </header>
    
    <!-- Search Section -->
    <section class="search-section">
        <div class="container">
            <div class="search-container">
                <div class="search-box">
                    <input type="text" class="search-input" id="searchInput" placeholder="üîç ‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡∏ó‡∏µ‡πà‡∏Ñ‡∏∏‡∏ì‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£...">
                    <button class="search-btn" onclick="searchProducts()">
                        <i class="fas fa-search"></i> ‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤
                    </button>
                </div>
            </div>
        </div>
    </section>
    
    <!-- Category Section -->
    <section class="category-section">
        <div class="container">
            <div class="category-tabs" id="categoryTabs">
                <button class="category-tab active" data-category="all">
                    <i class="fas fa-th-large"></i> ‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î
                </button>
                <button class="category-tab" data-category="electronics">
                    <i class="fas fa-laptop"></i> ‡∏≠‡∏¥‡πÄ‡∏•‡πá‡∏Å‡∏ó‡∏£‡∏≠‡∏ô‡∏¥‡∏Å‡∏™‡πå
                </button>
                <button class="category-tab" data-category="fashion">
                    <i class="fas fa-tshirt"></i> ‡πÅ‡∏ü‡∏ä‡∏±‡πà‡∏ô
                </button>
                <button class="category-tab" data-category="home">
                    <i class="fas fa-home"></i> ‡∏Ç‡∏≠‡∏á‡πÉ‡∏ä‡πâ‡πÉ‡∏ô‡∏ö‡πâ‡∏≤‡∏ô
                </button>
                <button class="category-tab" data-category="beauty">
                    <i class="fas fa-spa"></i> ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏á‡∏≤‡∏°
                </button>
                <button class="category-tab" data-category="sports">
                    <i class="fas fa-running"></i> ‡∏Å‡∏µ‡∏¨‡∏≤
                </button>
                <button class="category-tab" data-category="other">
                    <i class="fas fa-ellipsis-h"></i> ‡∏≠‡∏∑‡πà‡∏ô‡πÜ
                </button>
            </div>
        </div>
    </section>
    
    <!-- Stats Banner -->
    <section class="stats-banner">
        <div class="container">
            <div class="stats-container">
                <div class="stat-item">
                    <div class="stat-number" id="totalProducts">0</div>
                    <div class="stat-label">‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</div>
                </div>
                <div class="stat-item">
                    <div class="stat-number" id="todayProducts">0</div>
                    <div class="stat-label">‡∏•‡∏á‡∏Ç‡∏≤‡∏¢‡∏ß‡∏±‡∏ô‡∏ô‡∏µ‡πâ</div>
                </div>
                <div class="stat-item">
                    <div class="stat-number" id="soldProducts">0</div>
                    <div class="stat-label">‡∏Ç‡∏≤‡∏¢‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à</div>
                </div>
            </div>
        </div>
    </section>
    
    <!-- Main Content -->
    <main class="main-content">
        <div class="container">
            <h2 class="section-title">
                <i class="fas fa-fire"></i>
                <span id="sectionTitleText">‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î</span>
            </h2>
            
            <div id="productContainer">
                <!-- Loading State -->
                <div class="loading-container" id="loading">
                    <div class="spinner"></div>
                    <p class="mt-3 text-muted">‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÇ‡∏´‡∏•‡∏î‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤...</p>
                </div>
            </div>
        </div>
    </main>
    
    <!-- Footer -->
    <footer class="footer">
        <div class="container">
            <div class="footer-grid">
                <div class="footer-section">
                    <h4><i class="fas fa-store"></i> WiT Marketplace</h4>
                    <p>‡∏ï‡∏•‡∏≤‡∏î‡∏ã‡∏∑‡πâ‡∏≠‡∏Ç‡∏≤‡∏¢‡∏≠‡∏≠‡∏ô‡πÑ‡∏•‡∏ô‡πå C2C<br>‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠‡∏ú‡∏π‡πâ‡∏ã‡∏∑‡πâ‡∏≠‡∏ú‡∏π‡πâ‡∏Ç‡∏≤‡∏¢‡∏ú‡πà‡∏≤‡∏ô LINE OA<br>‡∏õ‡∏•‡∏≠‡∏î‡∏†‡∏±‡∏¢ ‡∏á‡πà‡∏≤‡∏¢ ‡∏£‡∏ß‡∏î‡πÄ‡∏£‡πá‡∏ß</p>
                    <div class="social-links">
                        <a href="https://line.me/R/ti/p/@563eikqn" target="_blank"><i class="fab fa-line"></i></a>
                        <a href="https://facebook.com/kruwitkub" target="_blank"><i class="fab fa-facebook-f"></i></a>
                        <a href="https://youtube.com/kruwitkub" target="_blank"><i class="fab fa-youtube"></i></a>
                    </div>
                </div>
                <div class="footer-section">
                    <h4>‡∏ß‡∏¥‡∏ò‡∏µ‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô</h4>
                    <a href="#"><i class="fas fa-angle-right"></i> ‡∏ß‡∏¥‡∏ò‡∏µ‡∏ã‡∏∑‡πâ‡∏≠‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤</a>
                    <a href="#"><i class="fas fa-angle-right"></i> ‡∏ß‡∏¥‡∏ò‡∏µ‡∏•‡∏á‡∏Ç‡∏≤‡∏¢‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤</a>
                    <a href="#"><i class="fas fa-angle-right"></i> ‡∏Ñ‡∏≥‡∏ñ‡∏≤‡∏°‡∏ó‡∏µ‡πà‡∏û‡∏ö‡∏ö‡πà‡∏≠‡∏¢</a>
                    <a href="#"><i class="fas fa-angle-right"></i> ‡∏ï‡∏¥‡∏î‡∏ï‡πà‡∏≠‡πÄ‡∏£‡∏≤</a>
                </div>
                <div class="footer-section">
                    <h4>‡∏ô‡πÇ‡∏¢‡∏ö‡∏≤‡∏¢</h4>
                    <a href="terms.html"><i class="fas fa-angle-right"></i> ‡πÄ‡∏á‡∏∑‡πà‡∏≠‡∏ô‡πÑ‡∏Ç‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô</a>
                    <a href="privacy.html"><i class="fas fa-angle-right"></i> ‡∏ô‡πÇ‡∏¢‡∏ö‡∏≤‡∏¢‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏õ‡πá‡∏ô‡∏™‡πà‡∏ß‡∏ô‡∏ï‡∏±‡∏ß</a>
                    <a href="#"><i class="fas fa-angle-right"></i> ‡∏ô‡πÇ‡∏¢‡∏ö‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏Ç‡∏≤‡∏¢</a>
                </div>
                <div class="footer-section">
                    <h4>‡∏•‡∏á‡∏Ç‡∏≤‡∏¢‡∏Å‡∏±‡∏ö‡πÄ‡∏£‡∏≤</h4>
                    <p>‡∏•‡∏á‡∏Ç‡∏≤‡∏¢‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡∏ü‡∏£‡∏µ! ‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ñ‡πà‡∏≤‡πÉ‡∏ä‡πâ‡∏à‡πà‡∏≤‡∏¢<br>‡πÄ‡∏û‡∏µ‡∏¢‡∏á‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ô LINE OA ‡πÅ‡∏•‡πâ‡∏ß‡∏û‡∏¥‡∏°‡∏û‡πå "‡∏Ç‡∏≤‡∏¢"</p>
                    <a href="https://line.me/R/ti/p/@563eikqn" target="_blank" class="btn-sell mt-2" style="display: inline-flex;">
                        <i class="fab fa-line"></i>
                        <span>‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ô LINE OA</span>
                    </a>
                </div>
            </div>
            <div class="footer-bottom">
                <p>¬© 2025 WiT Marketplace by Wizmobiz. All rights reserved.</p>
            </div>
        </div>
    </footer>
    
    <!-- Scroll to Top -->
    <button class="scroll-top" id="scrollTop">
        <i class="fas fa-arrow-up"></i>
    </button>
    
    <!-- AI Generator Button -->
    <button class="ai-generator-btn" id="aiGeneratorBtn" title="AI ‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÇ‡∏û‡∏™‡∏ï‡πå‡∏Ç‡∏≤‡∏¢">
        <i class="fas fa-magic"></i>
    </button>
    
    <!-- AI Modal -->
    <div class="ai-modal-overlay" id="aiModal">
        <div class="ai-modal">
            <div class="ai-modal-header" style="position: relative;">
                <button class="ai-modal-close" onclick="closeAIModal()">
                    <i class="fas fa-times"></i>
                </button>
                <h3><i class="fas fa-robot"></i> AI ‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÇ‡∏û‡∏™‡∏ï‡πå‡∏Ç‡∏≤‡∏¢</h3>
                <p>‡∏™‡πà‡∏á‡∏£‡∏π‡∏õ‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤ ‡πÉ‡∏´‡πâ AI ‡∏ä‡πà‡∏ß‡∏¢‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ô‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏Ç‡∏≤‡∏¢</p>
            </div>
            <div class="ai-modal-body">
                <!-- Upload Section -->
                <div id="aiUploadSection">
                    <div class="ai-upload-area" id="aiUploadArea" onclick="document.getElementById('aiFileInput').click()">
                        <div class="ai-upload-icon">
                            <i class="fas fa-cloud-upload-alt"></i>
                        </div>
                        <div class="ai-upload-text">
                            <strong>‡∏Ñ‡∏•‡∏¥‡∏Å‡∏´‡∏£‡∏∑‡∏≠‡∏•‡∏≤‡∏Å‡∏£‡∏π‡∏õ‡∏°‡∏≤‡∏ß‡∏≤‡∏á</strong>
                            <small>‡∏£‡∏≠‡∏á‡∏£‡∏±‡∏ö JPG, PNG ‡∏Ç‡∏ô‡∏≤‡∏î‡πÑ‡∏°‡πà‡πÄ‡∏Å‡∏¥‡∏ô 5MB</small>
                        </div>
                    </div>
                    <input type="file" id="aiFileInput" accept="image/*" style="display: none;" onchange="handleImageSelect(event)">
                    
                    <!-- Preview -->
                    <div class="ai-preview-container" id="aiPreviewContainer">
                        <img id="aiPreviewImage" class="ai-preview-image" src="" alt="Preview">
                        <button class="ai-new-btn" onclick="resetAIUpload()">
                            <i class="fas fa-redo"></i> ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏£‡∏π‡∏õ‡πÉ‡∏´‡∏°‡πà
                        </button>
                    </div>
                    
                    <!-- Extra Info -->
                    <div class="ai-extra-info">
                        <label><i class="fas fa-info-circle"></i> ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏ï‡∏¥‡∏° (‡πÑ‡∏°‡πà‡∏ö‡∏±‡∏á‡∏Ñ‡∏±‡∏ö)</label>
                        <textarea id="aiExtraInfo" rows="2" placeholder="‡πÄ‡∏ä‡πà‡∏ô ‡∏£‡∏≤‡∏Ñ‡∏≤, ‡∏™‡∏†‡∏≤‡∏û‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤, ‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡∏û‡∏¥‡πÄ‡∏®‡∏©..."></textarea>
                    </div>
                    
                    <button class="ai-generate-btn" id="aiGenerateBtn" onclick="generateAIPost()" disabled>
                        <i class="fas fa-sparkles"></i> ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏Ç‡∏≤‡∏¢
                    </button>
                </div>
                
                <!-- Loading -->
                <div class="ai-loading" id="aiLoading">
                    <div class="ai-loading-spinner"></div>
                    <p>ü§ñ AI ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û...</p>
                    <small>‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏£‡∏≠‡∏™‡∏±‡∏Å‡∏Ñ‡∏£‡∏π‡πà</small>
                </div>
                
                <!-- Result -->
                <div class="ai-result" id="aiResult">
                    <div class="ai-result-header">
                        <i class="fas fa-check-circle"></i>
                        <h4>AI ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏™‡∏£‡πá‡∏à‡πÅ‡∏•‡πâ‡∏ß!</h4>
                    </div>
                    
                    <div class="ai-product-info">
                        <div class="ai-info-item">
                            <label>üì¶ ‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤</label>
                            <span id="aiProductName">-</span>
                        </div>
                        <div class="ai-info-item price">
                            <label>üí∞ ‡∏£‡∏≤‡∏Ñ‡∏≤‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥</label>
                            <span id="aiSuggestedPrice">-</span>
                        </div>
                        <div class="ai-info-item">
                            <label>üìÅ ‡∏´‡∏°‡∏ß‡∏î‡∏´‡∏°‡∏π‡πà</label>
                            <span id="aiCategory">-</span>
                        </div>
                        <div class="ai-info-item">
                            <label>‚ú® ‡∏≠‡∏µ‡πÇ‡∏°‡∏à‡∏¥</label>
                            <span id="aiEmojis">-</span>
                        </div>
                    </div>
                    
                    <div class="ai-post-content">
                        <div class="ai-post-title" id="aiPostTitle"></div>
                        <div class="ai-post-description" id="aiPostDescription"></div>
                        <div class="ai-post-cta" id="aiPostCta"></div>
                        <div class="ai-post-hashtags" id="aiPostHashtags"></div>
                    </div>
                    
                    <div class="ai-actions">
                        <button class="ai-copy-btn" onclick="copyAIPost()">
                            <i class="fas fa-copy"></i> ‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å
                        </button>
                        <button class="ai-share-btn" onclick="shareToLine()">
                            <i class="fab fa-line"></i> ‡πÅ‡∏ä‡∏£‡πå LINE
                        </button>
                    </div>
                    
                    <button class="ai-new-btn" onclick="resetAIGenerator()">
                        <i class="fas fa-redo"></i> ‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÉ‡∏´‡∏°‡πà‡∏≠‡∏µ‡∏Å‡∏Ñ‡∏£‡∏±‡πâ‡∏á
                    </button>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Toast -->
    <div class="ai-toast" id="aiToast"></div>
    
    <!-- Bootstrap JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <!-- AOS JS -->
    <script src="https://unpkg.com/aos@2.3.1/dist/aos.js"></script>
    
    <script>
        // Firebase Configuration
        const firebaseConfig = {
            apiKey: "AIzaSyBxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx",
            authDomain: "appinjproject.firebaseapp.com",
            projectId: "appinjproject",
            storageBucket: "appinjproject.appspot.com",
            messagingSenderId: "123456789",
            appId: "1:123456789:web:abcdef123456"
        };

        // Initialize Firebase
        firebase.initializeApp(firebaseConfig);
        const db = firebase.firestore();

        // State
        let allProducts = [];
        let currentCategory = 'all';
        let searchQuery = '';

        // Initialize AOS
        AOS.init({
            duration: 600,
            easing: 'ease-out',
            once: true
        });

        // Format price
        function formatPrice(price) {
            return new Intl.NumberFormat('th-TH').format(price);
        }

        // Get time ago
        function getTimeAgo(timestamp) {
            if (!timestamp) return '';
            const date = timestamp.toDate ? timestamp.toDate() : new Date(timestamp);
            const now = new Date();
            const diff = now - date;
            
            const minutes = Math.floor(diff / 60000);
            const hours = Math.floor(diff / 3600000);
            const days = Math.floor(diff / 86400000);
            
            if (minutes < 60) return `${minutes} ‡∏ô‡∏≤‡∏ó‡∏µ‡∏ó‡∏µ‡πà‡πÅ‡∏•‡πâ‡∏ß`;
            if (hours < 24) return `${hours} ‡∏ä‡∏±‡πà‡∏ß‡πÇ‡∏°‡∏á‡∏ó‡∏µ‡πà‡πÅ‡∏•‡πâ‡∏ß`;
            if (days < 7) return `${days} ‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡πÅ‡∏•‡πâ‡∏ß`;
            return date.toLocaleDateString('th-TH');
        }

        // Check if product is new (within 24 hours)
        function isNewProduct(timestamp) {
            if (!timestamp) return false;
            const date = timestamp.toDate ? timestamp.toDate() : new Date(timestamp);
            const now = new Date();
            const diff = now - date;
            return diff < 86400000; // 24 hours
        }

        // Check if product is hot (many views)
        function isHotProduct(viewCount) {
            return viewCount >= 50;
        }

        // Render product card
        function renderProductCard(product) {
            let badge = '';
            if (product.status === 'sold') {
                badge = '<span class="product-badge badge-sold">‡∏Ç‡∏≤‡∏¢‡πÅ‡∏•‡πâ‡∏ß</span>';
            } else if (isNewProduct(product.createdAt)) {
                badge = '<span class="product-badge badge-new">‡πÉ‡∏´‡∏°‡πà</span>';
            } else if (isHotProduct(product.viewCount || 0)) {
                badge = '<span class="product-badge badge-hot">‡∏Æ‡∏¥‡∏ï</span>';
            }

            return `
                <div class="product-card" data-aos="fade-up" onclick="viewProduct('${product.id}')">
                    <div class="product-image">
                        <img src="${product.imageUrl || 'https://via.placeholder.com/300x300?text=No+Image'}" 
                             alt="${product.productName}"
                             loading="lazy"
                             onerror="this.src='https://via.placeholder.com/300x300?text=No+Image'">
                        ${badge}
                    </div>
                    <div class="product-info">
                        <div class="product-name">${product.productName}</div>
                        <div class="product-price">‡∏ø${formatPrice(product.price)}</div>
                        <div class="product-meta">
                            <div class="product-seller">
                                <i class="fas fa-user-circle"></i>
                                ${product.sellerName || '‡∏ú‡∏π‡πâ‡∏Ç‡∏≤‡∏¢'}
                            </div>
                            <div class="product-views">
                                <i class="fas fa-eye"></i>
                                ${product.viewCount || 0}
                            </div>
                        </div>
                    </div>
                </div>
            `;
        }

        // Render empty state
        function renderEmptyState(message) {
            return `
                <div class="empty-state">
                    <i class="fas fa-box-open"></i>
                    <h3>‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤</h3>
                    <p>${message}</p>
                </div>
            `;
        }

        // Render products
        function renderProducts(products) {
            const container = document.getElementById('productContainer');
            
            if (products.length === 0) {
                container.innerHTML = renderEmptyState(
                    searchQuery 
                        ? `‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡∏ó‡∏µ‡πà‡∏ï‡∏£‡∏á‡∏Å‡∏±‡∏ö "${searchQuery}"` 
                        : '‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡πÉ‡∏ô‡∏´‡∏°‡∏ß‡∏î‡∏´‡∏°‡∏π‡πà‡∏ô‡∏µ‡πâ'
                );
                return;
            }
            
            container.innerHTML = `
                <div class="product-grid">
                    ${products.map(renderProductCard).join('')}
                </div>
            `;
            
            // Reinitialize AOS for new elements
            AOS.refresh();
        }

        // Filter products
        function filterProducts() {
            let filtered = [...allProducts];
            
            // Filter by category
            if (currentCategory !== 'all') {
                filtered = filtered.filter(p => {
                    const tags = p.tags || [];
                    return tags.some(tag => tag.toLowerCase().includes(currentCategory.toLowerCase()));
                });
            }
            
            // Filter by search
            if (searchQuery) {
                const query = searchQuery.toLowerCase();
                filtered = filtered.filter(p => {
                    const name = (p.productName || '').toLowerCase();
                    const tags = (p.tags || []).join(' ').toLowerCase();
                    return name.includes(query) || tags.includes(query);
                });
            }
            
            renderProducts(filtered);
        }

        // Load products from Firestore
        async function loadProducts() {
            try {
                // Listen for real-time updates
                db.collection('marketplace_items')
                    .where('status', 'in', ['active', 'sold'])
                    .orderBy('createdAt', 'desc')
                    .limit(50)
                    .onSnapshot(snapshot => {
                        allProducts = [];
                        snapshot.forEach(doc => {
                            allProducts.push({ id: doc.id, ...doc.data() });
                        });
                        
                        filterProducts();
                        updateStats();
                    }, error => {
                        console.error('Error loading products:', error);
                        document.getElementById('productContainer').innerHTML = 
                            renderEmptyState('‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡πÇ‡∏´‡∏•‡∏î‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤');
                    });
                    
            } catch (error) {
                console.error('Error:', error);
                document.getElementById('productContainer').innerHTML = 
                    renderEmptyState('‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏•‡∏≠‡∏á‡πÉ‡∏´‡∏°‡πà');
            }
        }

        // Update stats
        function updateStats() {
            const total = allProducts.length;
            const today = allProducts.filter(p => isNewProduct(p.createdAt)).length;
            const sold = allProducts.filter(p => p.status === 'sold').length;
            
            animateNumber('totalProducts', total);
            animateNumber('todayProducts', today);
            animateNumber('soldProducts', sold);
        }

        // Animate number
        function animateNumber(elementId, target) {
            const element = document.getElementById(elementId);
            const current = parseInt(element.textContent) || 0;
            const increment = Math.ceil((target - current) / 20);
            
            if (current !== target) {
                const timer = setInterval(() => {
                    const newValue = parseInt(element.textContent) + increment;
                    if ((increment > 0 && newValue >= target) || (increment < 0 && newValue <= target)) {
                        element.textContent = target;
                        clearInterval(timer);
                    } else {
                        element.textContent = newValue;
                    }
                }, 30);
            }
        }

        // View product detail
        function viewProduct(productId) {
            window.location.href = `product.html?id=${productId}`;
        }

        // Search products
        function searchProducts() {
            searchQuery = document.getElementById('searchInput').value.trim();
            
            // Update title
            const titleText = document.getElementById('sectionTitleText');
            titleText.textContent = searchQuery 
                ? `‡∏ú‡∏•‡∏Å‡∏≤‡∏£‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤ "${searchQuery}"` 
                : '‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î';
            
            filterProducts();
        }

        // Category click handler
        document.getElementById('categoryTabs').addEventListener('click', (e) => {
            const tab = e.target.closest('.category-tab');
            if (!tab) return;
            
            // Update active state
            document.querySelectorAll('.category-tab').forEach(t => t.classList.remove('active'));
            tab.classList.add('active');
            
            // Update category
            currentCategory = tab.dataset.category;
            
            // Update title
            const titles = {
                'all': '‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î',
                'electronics': '‡∏≠‡∏¥‡πÄ‡∏•‡πá‡∏Å‡∏ó‡∏£‡∏≠‡∏ô‡∏¥‡∏Å‡∏™‡πå',
                'fashion': '‡πÅ‡∏ü‡∏ä‡∏±‡πà‡∏ô',
                'home': '‡∏Ç‡∏≠‡∏á‡πÉ‡∏ä‡πâ‡πÉ‡∏ô‡∏ö‡πâ‡∏≤‡∏ô',
                'beauty': '‡∏Ñ‡∏ß‡∏≤‡∏°‡∏á‡∏≤‡∏°',
                'sports': '‡∏Å‡∏µ‡∏¨‡∏≤',
                'other': '‡∏≠‡∏∑‡πà‡∏ô‡πÜ'
            };
            document.getElementById('sectionTitleText').textContent = titles[currentCategory] || '‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î';
            
            filterProducts();
        });

        // Search on Enter key
        document.getElementById('searchInput').addEventListener('keypress', (e) => {
            if (e.key === 'Enter') {
                searchProducts();
            }
        });

        // Scroll to top
        const scrollTopBtn = document.getElementById('scrollTop');
        window.addEventListener('scroll', () => {
            if (window.scrollY > 300) {
                scrollTopBtn.classList.add('visible');
            } else {
                scrollTopBtn.classList.remove('visible');
            }
        });

        scrollTopBtn.addEventListener('click', () => {
            window.scrollTo({ top: 0, behavior: 'smooth' });
        });

        // Initialize
        document.addEventListener('DOMContentLoaded', () => {
            loadProducts();
            initAIGenerator();
        });
        
        // ========================================
        // AI POST GENERATOR
        // ========================================
        
        let selectedImage = null;
        let currentAIPost = null;
        
        // Initialize AI Generator
        function initAIGenerator() {
            const btn = document.getElementById('aiGeneratorBtn');
            const modal = document.getElementById('aiModal');
            const uploadArea = document.getElementById('aiUploadArea');
            
            // Open modal
            btn.addEventListener('click', () => {
                modal.classList.add('show');
            });
            
            // Close on overlay click
            modal.addEventListener('click', (e) => {
                if (e.target === modal) {
                    closeAIModal();
                }
            });
            
            // Drag and drop
            uploadArea.addEventListener('dragover', (e) => {
                e.preventDefault();
                uploadArea.classList.add('drag-over');
            });
            
            uploadArea.addEventListener('dragleave', () => {
                uploadArea.classList.remove('drag-over');
            });
            
            uploadArea.addEventListener('drop', (e) => {
                e.preventDefault();
                uploadArea.classList.remove('drag-over');
                const file = e.dataTransfer.files[0];
                if (file && file.type.startsWith('image/')) {
                    processImage(file);
                }
            });
        }
        
        // Close modal
        function closeAIModal() {
            document.getElementById('aiModal').classList.remove('show');
        }
        
        // Handle image select
        function handleImageSelect(event) {
            const file = event.target.files[0];
            if (file) {
                processImage(file);
            }
        }
        
        // Process image
        function processImage(file) {
            if (file.size > 5 * 1024 * 1024) {
                showToast('‚ùå ‡πÑ‡∏ü‡∏•‡πå‡πÉ‡∏´‡∏ç‡πà‡πÄ‡∏Å‡∏¥‡∏ô‡πÑ‡∏õ (‡πÑ‡∏°‡πà‡πÄ‡∏Å‡∏¥‡∏ô 5MB)', 'error');
                return;
            }
            
            const reader = new FileReader();
            reader.onload = (e) => {
                selectedImage = e.target.result;
                document.getElementById('aiPreviewImage').src = selectedImage;
                document.getElementById('aiUploadArea').style.display = 'none';
                document.getElementById('aiPreviewContainer').style.display = 'block';
                document.getElementById('aiGenerateBtn').disabled = false;
            };
            reader.readAsDataURL(file);
        }
        
        // Reset upload
        function resetAIUpload() {
            selectedImage = null;
            document.getElementById('aiFileInput').value = '';
            document.getElementById('aiUploadArea').style.display = 'block';
            document.getElementById('aiPreviewContainer').style.display = 'none';
            document.getElementById('aiGenerateBtn').disabled = true;
        }
        
        // Generate AI Post
        async function generateAIPost() {
            if (!selectedImage) {
                showToast('‚ùå ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏£‡∏π‡∏õ‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡∏Å‡πà‡∏≠‡∏ô', 'error');
                return;
            }
            
            const extraInfo = document.getElementById('aiExtraInfo').value;
            
            // Show loading
            document.getElementById('aiUploadSection').style.display = 'none';
            document.getElementById('aiLoading').style.display = 'block';
            document.getElementById('aiResult').style.display = 'none';
            
            try {
                // Call Gemini API directly (client-side)
                const result = await callGeminiVision(selectedImage, extraInfo);
                
                if (result.success) {
                    currentAIPost = result.data;
                    displayAIResult(result.data);
                    showToast('‚úÖ ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à!', 'success');
                } else {
                    throw new Error(result.error);
                }
            } catch (error) {
                console.error('AI Error:', error);
                showToast('‚ùå ‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î: ' + error.message, 'error');
                resetAIGenerator();
            }
        }
        
        // Call Firebase Function for AI Vision
        async function callGeminiVision(imageData, extraInfo) {
            // Use Firebase Function instead of direct API key (more secure)
            const API_URL = 'https://us-central1-appinjproject.cloudfunctions.net/marketplaceAIGeneratePost';
            
            // Remove data URL prefix
            const base64Data = imageData.replace(/^data:image\/\w+;base64,/, '');
            
            const requestBody = {
                imageBase64: base64Data,
                additionalInfo: extraInfo || ''
            };
            
            const response = await fetch(API_URL, {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify(requestBody)
            });
            
            if (!response.ok) {
                const errorData = await response.json().catch(() => ({}));
                throw new Error(errorData.error || 'API request failed');
            }
            
            const data = await response.json();
            
            if (!data.success) {
                throw new Error(data.error || 'AI processing failed');
            }
            
            return data.data;  // Return parsed AI result directly
        }
        
        // Display AI Result
        function displayAIResult(data) {
            document.getElementById('aiLoading').style.display = 'none';
            document.getElementById('aiResult').style.display = 'block';
            
            document.getElementById('aiProductName').textContent = data.productName || '-';
            document.getElementById('aiSuggestedPrice').textContent = data.suggestedPrice || '-';
            document.getElementById('aiCategory').textContent = data.category || '-';
            document.getElementById('aiEmojis').textContent = data.emojis || '‚ú®';
            
            document.getElementById('aiPostTitle').textContent = data.title || '';
            document.getElementById('aiPostDescription').textContent = data.description || '';
            document.getElementById('aiPostCta').textContent = data.callToAction || '';
            
            const hashtags = data.hashtags ? data.hashtags.map(h => `#${h}`).join(' ') : '';
            document.getElementById('aiPostHashtags').textContent = hashtags;
        }
        
        // Copy AI Post
        function copyAIPost() {
            if (!currentAIPost) return;
            
            const hashtags = currentAIPost.hashtags ? currentAIPost.hashtags.map(h => `#${h}`).join(' ') : '';
            const fullPost = `${currentAIPost.title}\n\n${currentAIPost.description}\n\n${currentAIPost.callToAction}\n\n${hashtags}`;
            
            navigator.clipboard.writeText(fullPost).then(() => {
                const btn = document.querySelector('.ai-copy-btn');
                btn.innerHTML = '<i class="fas fa-check"></i> ‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å‡πÅ‡∏•‡πâ‡∏ß!';
                btn.classList.add('copied');
                showToast('üìã ‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢!', 'success');
                
                setTimeout(() => {
                    btn.innerHTML = '<i class="fas fa-copy"></i> ‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å';
                    btn.classList.remove('copied');
                }, 2000);
            });
        }
        
        // Share to LINE
        function shareToLine() {
            if (!currentAIPost) return;
            
            const hashtags = currentAIPost.hashtags ? currentAIPost.hashtags.map(h => `#${h}`).join(' ') : '';
            const text = `${currentAIPost.title}\n\n${currentAIPost.description}\n\n${currentAIPost.callToAction}\n\n${hashtags}`;
            const encoded = encodeURIComponent(text);
            
            window.open(`https://line.me/R/share?text=${encoded}`, '_blank');
        }
        
        // Reset AI Generator
        function resetAIGenerator() {
            document.getElementById('aiUploadSection').style.display = 'block';
            document.getElementById('aiLoading').style.display = 'none';
            document.getElementById('aiResult').style.display = 'none';
            resetAIUpload();
            document.getElementById('aiExtraInfo').value = '';
            currentAIPost = null;
        }
        
        // Show toast
        function showToast(message, type = 'default') {
            const toast = document.getElementById('aiToast');
            toast.textContent = message;
            toast.className = 'ai-toast show';
            if (type === 'success') toast.classList.add('success');
            
            setTimeout(() => {
                toast.classList.remove('show');
            }, 3000);
        }
        
        // =====================================================
        // üì± LINE AI POST DATA RECEIVER
        // ‡∏£‡∏±‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏≤‡∏Å LINE OA ‡∏ú‡πà‡∏≤‡∏ô URL Parameter
        // =====================================================
        
        function checkLineAIPostData() {
            const urlParams = new URLSearchParams(window.location.search);
            const aipostData = urlParams.get('aipost');
            
            if (aipostData) {
                try {
                    // Decode base64 data from LINE
                    const decodedData = JSON.parse(atob(decodeURIComponent(aipostData)));
                    console.log('üì± Received AI Post from LINE:', decodedData);
                    
                    // Set current AI post
                    currentAIPost = decodedData;
                    
                    // Auto open modal and display result
                    setTimeout(() => {
                        // Open the AI modal
                        const aiModal = new bootstrap.Modal(document.getElementById('aiGeneratorModal'));
                        aiModal.show();
                        
                        // Show result directly (skip upload section)
                        document.getElementById('aiUploadSection').style.display = 'none';
                        document.getElementById('aiLoading').style.display = 'none';
                        document.getElementById('aiResult').style.display = 'block';
                        
                        // Display the data
                        displayAIResult(currentAIPost);
                        
                        // Show welcome toast
                        showToast('üéâ ‡πÇ‡∏û‡∏™‡∏ï‡πå‡∏à‡∏≤‡∏Å LINE OA ‡∏û‡∏£‡πâ‡∏≠‡∏°‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å!', 'success');
                        
                        // Clean URL (remove aipost param)
                        const cleanUrl = window.location.pathname;
                        window.history.replaceState({}, document.title, cleanUrl);
                    }, 500);
                    
                } catch (error) {
                    console.error('‚ùå Error parsing LINE AI Post data:', error);
                }
            }
        }
        
        // Check on page load
        document.addEventListener('DOMContentLoaded', function() {
            checkLineAIPostData();
        });
    </script>
</body>
</html>
